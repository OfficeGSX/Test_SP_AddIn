---
title: プロバイダー向けのホスト型アドインにアドインの一部を含める
ms.prod: SHAREPOINT
ms.assetid: f77d528d-8b6d-4e2e-983c-3f3957983e9f
---


# プロバイダー向けのホスト型アドインにアドインの一部を含める
プロバイダー ホスト型の SharePoint アドインに SharePoint ページにリモート Web フォームを表示する方法について説明します。
これは、プロバイダー ホスト型 SharePoint アドインの開発の基本に関する記事のシリーズの 6 番目です。 [SharePoint アドイン](sharepoint-add-ins.md) およびこのシリーズの前の記事についてまず理解しておく必要があります。
  
    
    


-  [プロバイダー ホスト型 SharePoint アドインの作成を始める](get-started-creating-provider-hosted-sharepoint-add-ins.md)
    
  
-  [プロバイダー向けのホスト型アドインに SharePoint の外観を付与する](give-your-provider-hosted-add-in-the-sharepoint-look-and-feel.md)
    
  
-  [プロバイダー向けのホスト型アドインにカスタム ボタンを含める](include-a-custom-button-in-the-provider-hosted-add-in.md)
    
  
-  [SharePoint オブジェクト モデルの概要を簡単に説明する](get-a-quick-overview-of-the-sharepoint-object-model.md)
    
  
-  [プロバイダー向けのホスト型アドインに SharePoint の書き込み操作を追加する](add-sharepoint-write-operations-to-the-provider-hosted-add-in.md)
    
  

> **メモ**
> プロバイダー ホスト型アドインに関するこのシリーズを続けて学習している場合は、このトピックの学習に使用できる Visual Studio ソリューションがあります。また、 [SharePoint_Provider-hosted_Add-Ins_Tutorials](https://github.com/OfficeDev/SharePoint_Provider-hosted_Add-ins_Tutorials) でリポジトリをダウンロードして、BeforeAdd-inPart.sln ファイルを開くこともできます。
  
    
    

この記事では、アドイン パーツという名前の特別な種類の Web パーツを SharePoint アドインに追加します。アドイン パーツは、SharePoint ページでアドインの注文フォームを公開します。
## アドイン パーツを作成する


  
    
    

> **メモ**
>  Visual Studio 内のスタートアップ プロジェクトの設定では、ソリューションが開かれるたびに、既定値に戻ってしまう傾向があります。この一連の記事のサンプル ソリューションを再度開く場合は、すぐに次の手順を実行してください。>  [ **ソリューション エクスプローラー**] の上部にあるソリューション ノードを右クリックして、[ **スタートアップ プロジェクトを設定**] を選択します。 >  [ **操作**] 列で、3 つのプロジェクトすべてが [ **開始**] に設定されていることを確認します。 
  
    
    


1. [ **ソリューション エクスプローラー**] で、[ **ChainStore**] プロジェクトを右クリックし、[ **追加 | 新しいアイテム**] を選択します。
    
  
2. [ **クライアント Web パーツ (ホスト Web)**] を選択し、「注文」という名前を付けてから、[ **追加**] を押します. (「クライアント Web パーツ」は「アドイン パーツ」の別名です)。
    
  
3. ウィザードの次のページで、2 番目のラジオ ボタン [ **クライアント Web パーツのコンテンツの既存の Web ページの URL を選択または入力する**] を選択します。
    
  
4. ドロップダウン リストで、[ **OrderForm.aspx** ] ページの URL を選択してから、[ **完了**] を押します。
    
    アドイン パーツを定義する elements.xml ファイルがプロジェクトに追加され、開かれました。
    
  
5. **ClientWebPart** 要素では、次の属性をこれらの値に変更します。
    

|**属性**|**値**|
|:-----|:-----|
|タイトル  <br/> |注文  <br/> |
|説明  <br/> |注文するためのフォーム  <br/> |
|DefaultHeight  <br/> |320  <br/> |
   

    その他のすべての属性を既定の状態のままにし、ファイルを保存します。
    
  

## アドインを実行し、アドイン パーツをテストする


  
    
    

1. F5 キーを使用して、アドインを展開して実行します。Visual Studio は、IIS Express でリモート Web アプリケーションをホストし、SQL Express で SQL データベースをホストします。これにより、テスト SharePoint サイト上のアドインの一時的なインストールも実行され、アドインもすぐに実行されます。スタート ページが表示される前に、アドインへのアクセス許可を付与するように求められます。
    
  
2. アドインのスタート ページが開くと、アドインが展開されます。ユーザーは [ **注文**] アドイン パーツを使用して、香港ストアの Web サイト内の任意の SharePoint ページ上の任意の Web パーツ領域に追加できます。ホーム ページに追加するには、この手順に従います。
    
1. スタート ページの上部のクロム コントロールにある [ **サイトに戻る**] を押して、香港ストアのホーム ページを開きます。
    
  
2. リボンで [ **ページ**] タブを開き、[ **編集**] ボタンを押します。
    
  
3. ページが編集モードになったら、リボンの [ **挿入**] タブを開き、[ **アドイン パーツ**] ボタンを押します。(このボタンはまだ [ **アプリ パーツ**] になっている場合があります。)
    
  
4. Web パーツの挿入コントロールが開いたら、[ **注文**] アドイン パーツを選択します。コントロールは、次のようになります。
    
!\[SharePoint の Web パーツの挿入コントロールです。「注文」という部分が強調表示されています。その名前と説明が右側のボックスに表示されています。](images/aae61f89-2e9e-4808-8b0c-2439dad7c701.PNG)
  

  

  
5. フォームの Web パーツ領域のいずれかで任意の場所をクリックします。これは、アドイン パーツが配置される場所を設定するためです。 
    
  
6. Web パーツの挿入コントロールで、[ **追加**] をクリックします。[ **注文**] アドインが Web パーツ領域に追加されます。
    
  
7. リボンで [ **保存**] を押します。
    
  
3. これで、注文フォームがページに表示されます。これには、残りのページの概観も含まれており、次のように表示されます。 
    
!\[製品、仕入先、数量のテキスト ボックスがあるページの注文アドイン部分です。[注文] ボタンもあります。](images/beae2e3c-c1f4-4334-8ab8-0c42252cb2a2.PNG)
  

  

  
4. [ **仕入先**]、[ **製品**]、および [ **数量**] の値を入力し、[ **注文**] を押します。何も表示されませんが、注文は企業のデータベースに入力されます。必要に応じて、ページを更新し、アドイン パーツのフィールドを空にすることができます。
    
  
5. ブラウザーの [戻る] ボタンを使用して、チェーン ストア アドインのスタート ページに戻り、[ **表示注文**] を押します。新しいリクエストが表示されます。
    
  
6. デバッグ セッションを終了するには、ブラウザー ウィンドウを閉じるか、Visual Studio でデバッグを停止します。F5 を押すたびに、Visual Studio は以前のバージョンのアドインを取り消し、最新のアドインをインストールします。
    
  
7. このアドインおよび他の記事の Visual Studio ソリューションを操作し、それが終了したら前回のアドインを取り消すとよいでしょう。[ **ソリューション エクスプローラー**] のプロジェクトを右クリックして、[ **取り消し**] を選択します。
    
  

## 
<a name="Nextsteps"> </a>

 アドインは、手動で作成した 2 つのリストに依存します。ユーザーにこれを実行させる必要はありません。次の記事では、これらのリストを自動的に作成するプロセスを開始します。最初の主要な手順は、アドインをインストールするイベントのカスタム ハンドラーを作成します。 [プロバイダー向けのホスト型アドインでアドイン イベントを処理する](handle-add-in-events-in-the-provider-hosted-add-in.md)
  
    
    

