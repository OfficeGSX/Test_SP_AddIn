---
title: SharePoint アドインの 3 つの承認システム
ms.prod: SHAREPOINT
ms.assetid: 623fdab7-856e-4a89-9f5d-748a2ba1ef2e
---


# SharePoint アドインの 3 つの承認システム
SharePoint アドイン が SharePoint のリソースへの権限の承認の取得に使用できる 3 つのシステムについて説明します。
SharePoint では、SharePoint アドイン はユーザーと同様の ID プリンシパルであり、SharePoint リソースを使用するよう認証と承認が行われる必要があります。アドインが使用できる承認システムは 3 つあります。これらは相互に排他的ではありません。
  
    
    


## 3 つの承認システムと、使用するタイミングを理解する
<a name="UnderstandThreeSystems"> </a>


  
    
    

- **低信頼**: プロバイダー向けのホスト型 SharePoint アドイン は、アドインがインストールされる SharePoint テナンシーまたはファームのリソースにアドインがアクセスできるようにするため、アドインにアクセス トークンを発行する Microsoft Azure アクセス制御サービス (ACS) に登録できます。Azure ACS は、SharePoint とアドインのリモート コンポーネントを含む OAuth 2.0 フレームワーク "フロー" の信頼されたトークン発行者です。このシステムを使用するアドインは Office ストア で販売できます。低信頼システムは、主にリモート コンポーネントがクラウドでホストされるアドインを対象としています。
    
    低信頼システムを使用する SharePoint アドイン の作成の詳細については、SDK ノードの「 [低信頼承認を使用する SharePoint アドインの作成](creating-sharepoint-add-ins-that-use-low-trust-authorization.md)」を参照してください。
    
    > **メモ**
      > アドインをインストールするお客様は、Office 365 アカウントを持っている必要があります。これは、アドインに Azure ACS へのアクセス権を付与するために必要です。ただし、お客様は他の目的にはこのアカウントを使用する必要はなく、オンプレミスの SharePoint ファームでいくつかの簡単な構成タスクを行ってから、そのファームにアドインをインストールできます。 
- **高信頼**: プロバイダー向けのホスト型アドインは、デジタル証明書を使用して SharePoint と信頼関係を確立できます。高信頼システムは、主にリモート コンポーネントがオンプレミスでホストされるアドインを対象としています。アドインは、インターネットに接続されない SharePoint ファームにインストールできます。アドインは、SharePoint Online にインストールすることも、Office ストア で販売することもできません。
    
    高信頼システムを使用する SharePoint アドイン の作成の詳細については、SDK ノードの「 [高信頼認証システムを使用する SharePoint アドインを作成する](creating-sharepoint-add-ins-that-use-high-trust-authorization.md)」を参照してください。
    
  
- **クロス ドメイン ライブラリ**: アドインのビジネス ロジックが JavaScript にある場合、SharePoint クロス ドメイン ライブラリを、低信頼システムおよび高信頼システムの代わりまたは補足として使用するオプションがあります。また、ライブラリは、アドインがクラウド ホスト型コンポーネントを持っているが、お客様の企業ファイアウォールのため、低信頼システムを使用するのが難しいシナリオも対象としています。ユーザーのブラウザーは他のドメインからのスクリプトをブロックしますが、この制限を回避するためにライブラリがセキュリティで保護されたシステムをカプセル化します。ライブラリを使用するアドインは、Office ストア で販売することができ、SharePoint Online またはオンプレミスの SharePoint のいずれかにインストールできます。
    
    ドメイン間ライブラリを使用する SharePoint アドイン の作成の詳細については、SDK ノードの「 [クロス ドメイン ライブラリを使用する SharePoint アドインの作成](creating-sharepoint-add-ins-that-use-the-cross-domain-library.md)」、ブログ投稿「 [Solving cross-domain problems in SharePoint Add-ins](http://blogs.msdn.com/b/officeapps/archive/2012/11/29/solving-cross-domain-problems-in-apps-for-sharepoint.aspx)」を参照してください。
    
  

## OAuth 2.0 Framework と SharePoint におけるその実装に関する背景情報
<a name="UnderstandThreeSystems"> </a>

3 つの承認システムのうち 2 つが OAuth 2.0 フレームワークを使用します。OAuth 2.0 は、 **承認のためのオープン フレームワーク** です。OAuth により、デスクトップ アプリケーション、デバイス アプリケーション、および Web アプリケーションからセキュリティで保護された認証を標準的な方法で実行できるようになります。また、ユーザーは、ユーザー名とパスワードを提供せずに、自分に代わってアプリケーションが処理を実行することを承認できます。たとえば、個人的なリソースやデータ (連絡先リスト、ドキュメント、写真、動画など) を 1 つのサイトと別のサイトで **ユーザーが共有する** 際に、自分の資格情報 (通常はユーザー名とパスワード) を他方のサイトに提供する必要がありません **without requiring the user to provide his or her credentials**。
  
    
    
OAuth を使用すると、特定のサービス プロバイダー (たとえば SharePoint) によってホストされているデータに対して、ユーザーがアクセス トークンを提供できます。各トークンは、特定のリソース プロバイダー (たとえば SharePoint Web サイト) が、特定のリソース (たとえば SharePoint ドキュメント ライブラリ内のドキュメント) を、定義された期間 (たとえば 12 時間) にわたってアクセスする許可を与えます。このしくみを利用すると、サード パーティの Web またはデスクトップ アプリケーションに、別のリソースまたはサービス プロバイダー (たとえば SharePoint) に格納されている情報にアクセスすることをユーザーが許可できます。その際に、ユーザーは自分のユーザー名やパスワードを提供する必要がなく、そのプロバイダーに格納されている自分のデータ *すべて*  を共有する必要もありません。
  
    
    
 **OAuth 2.0** フレームワークを使用する SharePoint は、 **トークン受け渡し "フロー" を使用して** 、次の処理を行います。
  
    
    

- SharePoint リソースにアクセスするという SharePoint アドイン からの要求を承認します。
    
  
- Office ストア、アドイン カタログ、または開発者テナントにあるアドインを認証します。
    
  
OAuth と OAuth の用語の詳細や背景については、「 [OAuth.net](http://oauth.net/)」と「 [Web Authorization Protocol (oauth)](http://datatracker.ietf.org/doc/active/)」を参照してください。要約すると、保護されたリソースをホストするリソース サーバーがあり、リソースの所有者がおり、リソースへのアクセスを求めるクライアント アプリケーションがあり、リソース所有者に指示された時にリソースに対するアクセス トークンを発行する承認サーバーがあります。OAuth の公式のドキュメントでは、1 人のリソース所有者が、クライアント アプリケーションが実行されるたびにクライアント アプリケーションからリソースへのアクセスを許可し、そのクライアント アプリケーションを使用するのはリソース所有者である、というシナリオを想定することが多いようです。それに対して、SharePoint の実装では、SharePoint リソース (たとえばリスト) を複数のユーザーで共有する場合があることを考慮に入れています。さらに、SharePoint の実装では、SharePoint アドイン にアクセス許可が付与されるのは実行時に毎回ではなくインストール時であり、アドインをインストールしたユーザーやアクセス許可を付与したユーザー以外のユーザーがそのアドインを実行できます。(ただし、SharePoint 上にインストールされずに SharePoint リソースにアクセスするアドイン ("SharePoint アドイン" の意味を拡大解釈したもの) の場合は、アドインを実行するたびに、アドインを実行するユーザーがアクセス許可を付与する必要があります。)
  
    
    
したがって、SharePoint の実装で OAuth のそれぞれの役割を果たすのは次のコンポーネントです。
  
    
    

- SharePoint アドイン のリモート コンポーネントは、クライアント アプリケーションの役割を果たします。
    
  
- SharePoint ユーザーは、リソース所有者の役割を果たします。
    
  
- SharePoint は、リソース サーバーの役割を果たします。
    
  
-  [低信頼の承認システム](creating-sharepoint-add-ins-that-use-low-trust-authorization.md)が使用される場合は、Azure ACS が承認サーバーの役割を果たします。 [高信頼システム](creating-sharepoint-add-ins-that-use-high-trust-authorization.md)が使用される場合は、アドインそのものが (デジタル証明書と併用されることにより)、承認サーバーになります。
    
  

### アクセス トークンはサインイン トークンではない
<a name="FileName_uniquekeyword3"> </a>

これまで説明したとおり、アドインがリソースにアクセスするには、信頼されたセキュリティ トークン発行者 (STS) としてリソース所有者によって事前に指定された OAuth 承認サーバーからのアクセス トークンを要求する必要があります。それに対して、WS-Federation STS や SAML (Security Assertion Markup Language) パッシブ サインイン STS は、主にサインイン トークンの発行を目的としています。SharePoint では、OAuth STS はサインイン トークンの発行には使用されず、ID プロバイダーとして使用されることはありません。このため、ユーザー サインイン ページや、サーバーの全体管理サイトの [ **認証プロバイダー**] セクションや、SharePoint のユーザー選択ウィンドウの一覧に OAuth STS は表示されません。
  
    
    
SharePoint 管理者は、Windows PowerShell コマンドを使用して OAuth STS を有効または無効にすることができます。これは、SharePoint 2010 で信頼済みログイン プロバイダーを有効または無効にする方法と同様です。 
  
    
    

