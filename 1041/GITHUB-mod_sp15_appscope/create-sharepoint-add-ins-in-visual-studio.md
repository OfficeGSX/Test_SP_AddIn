---
title: Visual Studio で SharePoint アドインを作成する
ms.prod: SHAREPOINT
ms.assetid: f1b9c858-907c-4558-b671-3b488ece40a0
---



# Visual Studio で SharePoint アドインを作成する
Visual Studio でのプロジェクトとプロジェクト アイテムのテンプレートを使用した SharePoint アドインの開発について説明します。
 **vsnv** では、プロジェクトとプロジェクト アイテムの新しいテンプレートを使用して SharePoint アドインを開発できます。





## プロジェクト テンプレート
<a name="SP15Projecttemplates_templates"> </a>

Visual Studio でプロジェクト テンプレートを使用すると、プロジェクトの種類に必要なプロジェクト アイテムおよびファイルを含むソリューションが作成されます。[ **Office/SharePoint**] ノードを展開して [ **アドイン**] ノードを選択すると、[ **新しいプロジェクト**] ダイアログ ボックスに次のプロジェクト テンプレートが表示されます。[ **SharePoint ソリューション**] ノードの下のプロジェクト テンプレートの詳細については、「 [SharePoint プロジェクトとプロジェクト項目テンプレート](http://go.microsoft.com/fwlink/?LinkId=255306)」を参照してください。 




### Office アドイン

Excel や Outlook などの Office アプリケーション内でホストされる Web ページを作成します。Office アドインは、ドキュメントや Outlook アイテムに追加のコンテンツと機能を提供します。詳細については、「 [Office 用アプリの構築を開始する](http://msdn.microsoft.com/library/e64de870-ce22-4331-92e7-76d35279bf91%28Office.15%29.aspx)」を参照してください。




### SharePoint アドイン

ウィザードで指定した情報に基づいて SharePoint アドインを作成します。この情報には、次のデータが含まれます。




- アドインの名前


- アドインのデバッグに使用するローカルまたはリモートの SharePoint サイト


- 作成するアドインの種類 (プロバイダー向けのホスト型、または SharePoint ホスト型) 


詳細については、「 [SharePoint アドイン](sharepoint-add-ins.md)」を参照してください。




### クラウド ビジネス アドイン

Visual Studio で [ **クラウド ビジネス アドイン**] テンプレートを使用すると、モバイル ユーザーがリモートの場所から電話やタブレットなどの最新のタッチ指向デバイスを使ってデータの表示、追加、更新ができる SharePoint ホスト型アドインを作成できます。詳細については、「 [クラウド ビジネス アドインを作成する](create-cloud-business-add-ins.md)」を参照してください。




## プロジェクト アイテム テンプレート
<a name="SP15Projecttemplates_items"> </a>

SharePoint ソリューションを作成したら、次のテンプレートを使用してプロジェクト アイテムを追加できます。これらのテンプレートは、[ **Office/SharePoint**] ノード下の [ **新しいアイテムの追加**] ダイアログ ボックスに表示されます。




### Office アドイン

SharePoint アドインに Office アドインを追加します。作業ウィンドウ アドイン、コンテンツ アドイン、またはメール アドインを追加できます。詳細については、「 [Office 用アプリの構築を開始する](http://msdn.microsoft.com/library/e64de870-ce22-4331-92e7-76d35279bf91%28Office.15%29.aspx)」を参照してください。




### クライアント Web パーツ (ホスト Web)

クライアント Web パーツを SharePoint アドインに追加します。クライアント Web パーツを追加すると、ホスト サイトのページにアドインを表示できます。このテンプレートには単一の Elements.xml ファイルが含まれ、このプロパティではクライアント Web パーツの次の要素を定義します。





|**プロパティ名**|**説明**|
|:-----|:-----|
|ClientWebPart  <br/> |クライアント Web パーツの名前、タイトル、説明、およびディメンションを指定します。  <br/> |
|Content  <br/> |クライアント Web パーツ内でレンダリングされるページの場所を定義します。この要素には、 `Type` と `Src` の 2 つのプロパティが含まれます。 `Type` では、HTML などの作成中の Web パーツの種類を指定します。 `Src` では、クライアント Web パーツ内でレンダリングされるページの場所を定義します。テンプレートでは _PropertyName__のパターンを使用してクエリ文字列のプロパティを参照します (例:  `Src="~addinWebUrl/Pages/ClientWebPart1.aspx?Property1=_property1_"`)。  <br/> 詳細については、「 [アドイン パーツを作成して SharePoint アドインと共にインストールする](create-add-in-parts-to-install-with-your-sharepoint-add-in.md)」を参照してください。  <br/> |
 

### コンテンツの種類

SharePoint の以前のバージョンで使用されていたコンテンツ タイプと同様に、SharePoint アドインにコンテンツ タイプを追加します。コンテンツ タイプとは、SharePoint リストまたはライブラリにあるアイテムのカテゴリに対するメタデータ、ワークフロー、および動作のセットです。たとえば、アイテムはリスト コンテンツの一種です。他の種類のリスト コンテンツには、お知らせ、連絡先、およびタスクが含まれ、それらはアイテム コンテンツ タイプから継承されます。連絡先コンテンツ タイプには、[ **名**]、[ **姓**]、[ **役職**] などの列が含まれます。



SharePoint アドインにコンテンツ タイプを追加するときは、新しいコンテンツ タイプが継承する基本コンテンツ タイプを指定します。たとえば、お知らせ、連絡先、ドキュメント、アイテムのいずれかのコンテンツ タイプから継承できます。それから **コンテンツ タイプ** デザイナーを使用すると、コンテンツ タイプの列、および名前や説明などのその他のプロパティを構成できます。選択した値は、Elements.xml ファイルの `ContentType` 要素と `FieldRef` 要素に追加されます。詳細については、「 [構成要素: コンテンツ タイプ](http://msdn.microsoft.com/library/277dfc42-d9a8-4fae-9ae1-0d202b14674f%28Office.15%29.aspx)」を参照してください。




### 空の要素

空の要素のプロジェクト アイテムを SharePoint アドインに追加します。このプロジェクト アイテムには単一のファイル Elements.xml が含まれ、このファイルで要素のプロパティを定義します。空の要素は一般に、Visual Studio がテンプレートを提供していないアイテムを定義するために使用します。




### リスト

リスト定義とリストのインスタンスの 2 つのプロジェクト アイテムを SharePoint アドインに追加します。アドインにリストを追加するときは、リストに付ける名前と、空のリストと既存のリストの種類に基づくリストのどちらを作成するのかを指定します。また、リストをカスタマイズできるかどうかも指定します。それから **リスト デザイナー**を使用して、リストの列およびビュー、リストの名前および説明などのその他のプロパティを構成します。詳細については、「 [ListTemplate 要素 (リスト テンプレート)](http://msdn.microsoft.com/library/e565ead9-adcb-4a90-97e3-04850719420a%28Office.15%29.aspx)」および「 [ListInstance 要素 (リスト インスタンス)](http://msdn.microsoft.com/library/cfefe8e5-2656-4d71-bb4e-5f991a800598%28Office.15%29.aspx)」を参照してください。




### メニュー アイテムのカスタム アクション

リスト メニューにアクションを追加して、ホスト サイトの UI を拡張するプロジェクト アイテムを追加します。メニュー カスタム アクションには Elements.xml ファイルが含まれます。このファイルは、アクションのプロパティを定義するのに使用します。詳細については、「 [カスタム アクションを作成して SharePoint アドインで展開する](create-custom-actions-to-deploy-with-sharepoint-add-ins.md)」を参照してください。




### モジュール

モジュール プロジェクト アイテムを SharePoint アドインに追加します。モジュールは基本的に、SharePoint アドインを展開するときにその他のファイルを格納するために使用できるコンテナーです。ファイルを追加するには、 **ソリューション エクスプローラー**でモジュール下のプロジェクトにファイルをコピーします。ファイルへの参照はモジュールの Elements.xml ファイルに自動的に追加され、参照によって新しいファイルのパスおよび URL が指定されます。モジュールに含まれている Sample.txt ファイルはサンプルとして含まれているだけなので、削除することができます。




### リモート イベント レシーバー

リモート イベント レシーバーのプロジェクト アイテムを SharePoint アドインに追加し、そのようなプロジェクトがまだ存在しない場合は、Web アプリケーション プロジェクトをソリューションに追加します。Web アプリケーションには、SharePoint アドインのリモート イベント レシーバーと関連付けられている Web サービスが含まれます。Web サービスには Visual Basic または Visual C# コード ファイルが含まれ、このコードは SharePoint アドインでリスト、リスト アイテム、または Web アイテム イベントが発生したときに実行されます。Web アプリケーションが存在する場合は SharePoint アドインと関連付けられ、Web サービスがそのアプリケーションに追加されます。詳細については、「 [SharePoint アドインのイベントの処理](handle-events-in-sharepoint-add-ins.md)」を参照してください。




### リボン カスタム アクション

リボンにアクションを追加して、ホスト サイトの UI を拡張するプロジェクト アイテムを追加します。リボン カスタム アクションには Elements.xml ファイルが含まれます。このファイルは、アクションのプロパティを定義します。詳細については、「 [カスタム アクションを作成して SharePoint アドインで展開する](create-custom-actions-to-deploy-with-sharepoint-add-ins.md)」を参照してください。




### 検索構成

SharePoint サイトからエクスポートされたカスタム検索構成の設定をインポートできるようにするプロジェクト アイテムを追加します。




### サイト列

サイト列のプロジェクト アイテムを SharePoint アドインに追加します。サイト列には、サイト列の  `Field` プロパティを定義する Elements.xml ファイルが含まれます。このプロパティには次のデータが含まれます。





|**プロパティ名**|**説明**|
|:-----|:-----|
|ID  <br/> |サイト列の一意の GUID 値。  <br/> |
|Name  <br/> |サイト列の参照に使用される一意の名前。  <br/> |
|DisplayName  <br/> |UI に表示されるフレンドリ名。  <br/> |
|Type  <br/> |**SPFieldType** に基づくサイト列のデータ型 (ブール型、参照型、またはテキスト型)。 <br/> |
|Required  <br/> |列が必須の場合、このプロパティは **True** に設定されます。必須でない場合は **False** に設定されます。 <br/> |
|Group  <br/> |サイト列が割り当てられるグループの名前を指定します。このプロパティの既定値は **Custom Site Columns** です。 <br/> |
 
詳細については、「 [構成要素: 列とフィールド型](http://msdn.microsoft.com/library/58548ade-e439-4931-82a2-fa29bd5afdb7%28Office.15%29.aspx)」を参照してください。




### ワークフロー

Microsoft Azure ワークフローのプロジェクト アイテムを SharePoint アドインに追加します。詳細については、「 [SharePoint 2013 のワークフロー](http://msdn.microsoft.com/library/e0602371-ae22-44be-8a7e-9e47e9f046d6%28Office.15%29.aspx)」を参照してください。この種類のアイテムを追加するときは、ワークフローの名前と、それがリスト ワークフローかサイト ワークフローかを指定します。名前が示すように、リスト ワークフローはリストでのみ機能し、サイト ワークフローは SharePoint サイトでのみ機能します。ワークフローの作成時には、ワークフローをリストおよびライブラリと自動的に関連付けるかどうかも指定し、関連付ける場合は関連付ける対象を指定します。追加するすべての関連付けごとに、関連付けのファイルがワークフロー プロジェクトに追加されます。ワークフローには次のファイルが含まれます。





|**ファイル名**|**説明**|
|:-----|:-----|
|Elements.xml  <br/> |ワークフローの構成と、workflow.xaml ファイルや関連付けファイルなどのワークフローに含まれるファイル、および URL、種類、パスなどの各ファイルのプロパティを指定します。ワークフロー プロジェクトに追加されるファイルごとに、対応するセクションがワークフローの Elements.xml ファイルに追加されます。リスト ワークフローの関連付けファイルはリストを必要とするため、これらにはリスト トークンへの参照が含まれます。サイト ワークフローでは、サイトに GUID が追加されます。  <br/> > **注意**> Visual Studio では Elements.xml ファイルのアイテムが維持されるため、変更の影響について十分に理解している場合を除き変更しないことをお勧めします。           |
|Workflow.xaml  <br/> |ワークフローのデザイナーを表示します。このファイルでは、ワークフローにアクションを追加し、それらのコードおよびプロパティを設定します。  <br/> |
|WorkflowStartAssociation  <br/> |SharePoint でワークフローを手動で開始します。このファイルは、ワークフロー ウィザードの [ **ユーザーが手動でワークフローを開始**] チェック ボックスがオンになっている場合にワークフロー プロジェクトに追加されます。  <br/> |
|ItemAddedAssociation  <br/> |ユーザーがサイトまたはリスト (ワークフローの種類による) でアイテムを作成したときにワークフローが存在する場合、ワークフローを自動的に開始します。このファイルは、ワークフロー ウィザードの [ **項目が作成されたときにワークフローを自動的に開始**] チェック ボックスがオンになっている場合にワークフロー プロジェクトに追加されます。  <br/> |
|ItemUpdatedAssociation  <br/> |ユーザーがサイトまたはリスト (ワークフローの種類による) でアイテムを変更したときにワークフローが存在する場合、ワークフローを自動的に開始します。このファイルは、ワークフロー ウィザードの [ **項目が変更されたときにワークフローを自動的に開始**] チェック ボックスがオンになっている場合にワークフロー プロジェクトに追加されます。  <br/> |
|WorkflowHistoryList  <br/> |ワークフロー ウィザードでワークフロー履歴リストを作成する場合、ワークフロー プロジェクトに追加されたファイルを表します。  <br/> |
|WorkflowTaskList  <br/> |ワークフロー ウィザードでワークフロー タスク リストを作成する場合、ワークフロー プロジェクトに追加されたファイルを表します。  <br/> |
 

### ワークフロー カスタム アクティビティ

SharePoint アドインにワークフロー カスタム アクティビティのプロジェクト アイテムを追加します。ワークフロー カスタム アクティビティを追加すると、追加のワークフロー アクションを作成し、後でそれを SharePoint Designer 2013 にカスタム アクションとしてインポートできます。ワークフロー カスタム アクティビティには Elements.xml ファイルとワークフロー デザイナーの .xaml ファイルが含まれます。Elements.xml ファイルは、アクションのプロパティを定義します。詳細については、「 [SharePoint 2013 のワークフロー](http://msdn.microsoft.com/library/e0602371-ae22-44be-8a7e-9e47e9f046d6%28Office.15%29.aspx)」を参照してください。




## その他の技術情報
<a name="SP15Projecttemplates_addlresources"> </a>


-  [SharePoint アドインを開発するためのツールと環境](tools-and-environments-for-developing-sharepoint-add-ins.md)


