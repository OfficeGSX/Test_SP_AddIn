---
title: Существует три способа рассмотрения возможностей проектирования надстроек SharePoint
ms.prod: SHAREPOINT
ms.assetid: 0942fdce-3227-496a-8873-399fc1dbb72c
---


# Существует три способа рассмотрения возможностей проектирования надстроек SharePoint
В этой статье содержатся сведения о параметрах архитектуры и проекта, доступные с помощью Надстройки SharePoint. Предварительно необходимо ознакомиться со статьей  [Надстройки SharePoint](sharepoint-add-ins.md).
## Общие сведения и первое решение
<a name="Overview"> </a>

В этой статье рассматриваются три различных способа по выбору архитектуры для Надстройки SharePoint. Во-первых, приводятся наиболее важные категории выбора проектных решений; во-вторых, показывается архитектура надстройки относительно уровней приложений; и, в-третьих, открываются факторы, которые необходимо учитывать при выборе ваших проектных решений.
  
    
    
Но для начала нужно решить, что будет представлять собой ваше расширение SharePoint: надстройку Надстройка SharePoint или классическое решение решение фермы или изолированные решения SharePoint. Некоторые части объектной модели SharePoint, главным образом, подключаются с помощью настраиваемого администрирования и безопасности SharePoint, и не доступны клиентам. Клиентам может быть доступен только пользовательский код, выполняемый на сервере SharePoint, в то время как на стороне сервера пользовательский код недопустим в Надстройка SharePoint (богатый набор клиентских объектных моделей и сервис REST/OData позволяют Надстройки SharePoint сделать почти любое расширение SharePoint, ориентированное на конечного пользователя). Дополнительные сведения о выборе между классическими решениями и надстройками см. в статье  [Сравнение надстроек SharePoint с решениями SharePoint](http://msdn.microsoft.com/library/0e9efadb-aaf2-4c0d-afd5-d6cf25c4e7a8%28Office.15%29.aspx). При создании решения поможет статья  [Выбор правильного набора API в SharePoint 2013](http://msdn.microsoft.com/library/f36645da-77c5-47f1-a2ca-13d4b62b320d%28Office.15%29.aspx).
  
    
    

## Основные элементы в проекте надстроек SharePoint
<a name="MajorCategoriesOfChoices"> </a>

Существует три основных категории выбора при проектировании Надстройка SharePoint. Как обычно, проектирование приложения требует некоторых издержек; выбор в одной категории может ограничить ваши возможности в другой. Не каждая комбинация вариантов выбора возможна.
  
    
    

- **Размещение.**Надстройки SharePoint Оно делится на два основных типа в зависимости от способа развертывания и размещения. 
    
  - **Размещаемые у поставщика** надстройки имеют свое основное хранилище данных и бизнес-логику, развертываемые и устанавливаемые вами как разработчиком вне SharePoint на серверах или в облачной учетной записи, которые вы предоставляете. Вы должны принудительно разделить учетные записи различных потребителей, которые приобрели вашу надстройку. В таких надстройках также могут содержаться компоненты SharePoint. Они размещаются в ферме SharePoint пользователя. Этот тип надстройки предоставляет самую высокую гибкость в других категориях выбора проектных решений. Это также позволяет использовать платформы не Майкрософт для внешних данных, логики и пользовательского веб-интерфейса (UI) (Внутри категории надстроек, размещаемых у поставщика, необходимо различать надстройки, чьи удаленные компоненты находятся в одной и той же сети брандмауэра предприятия, как ферма SharePoint, и те надстройки, чьи компоненты установлены вне этого брандмауэра. Системы авторизации в этих двух случаях различаются, что, в свою очередь, создает различие в применении языка программирования для доступа к данным SharePoint.)
    
  
  - **Размещаемые в SharePoint** надстройки полностью состоят из компонентов SharePoint 2013, таких как списки, типы содержимого, рабочие процессы и веб-части. Внешние компоненты отсутствуют. Дополнительные сведения о типах компонентов SharePoint, которые можно включить в Надстройки SharePoint, см. в статье [Хост-сайты, сайты надстроек и компоненты SharePoint в SharePoint 2013](host-webs-add-in-webs-and-sharepoint-components-in-sharepoint-2013.md).
    
  

    Подробнее о параметрах размещения Надстройки SharePoint можно узнать в статье  [Выбор шаблонов для разработки и размещения надстройки SharePoint](choose-patterns-for-developing-and-hosting-your-sharepoint-add-in.md).
    
  
- **Подключение.**SharePoint 2013 Поддерживает три типа безопасного доступа к данным: создание/чтение/обновление/удаление (CRUD).
    
  - Внешние веб-приложения в надстройке для доступа к данным SharePoint используют протокол OAuth. Дополнительные сведения см. в статье  [Авторизация и проверка подлинности для надстроек в SharePoint 2013](authorization-and-authentication-of-sharepoint-add-ins.md).
    
  
  - JavaScript может иметь доступ к данным в веб-приложении SharePoint и данным на других веб-сайтах в рамках одной и той же аренды, используя специальную библиотеку JavaScript, позволяющую безопасно выполнять межсайтовые сценарии. Дополнительные сведения см. в статье  [Обращение к данным SharePoint 2013 из надстроек с помощью междоменной библиотеки](access-sharepoint-2013-data-from-add-ins-using-the-cross-domain-library.md).
    
  
  - Кроме того, Надстройка SharePoint может получить доступ к внешним данным через Службы Business Connectivity Services (BCS) или прокси-сервер веб-службы. Узнать больше об этом можно в статьях  [Business Connectivity Services в SharePoint 2013](http://msdn.microsoft.com/library/64b7d032-4b83-4e9e-bc08-f0a161af5457%28Office.15%29.aspx) и [Отправка запросов удаленной службе с помощью веб-прокси в SharePoint 2013](query-a-remote-service-using-the-web-proxy-in-sharepoint-2013.md).
    
  

    Дополнительные сведения о хранении данных и доступа к ним в Надстройки SharePoint см. в статье  [Данные в надстройках SharePoint](important-aspects-of-the-sharepoint-add-in-architecture-and-development-landscap.md#Data),  [Безопасный доступ к данным и клиентские объектные модели для надстроек SharePoint](secure-data-access-and-client-object-models-for-sharepoint-add-ins.md) и [Работа с внешними данными в SharePoint 2013](work-with-external-data-in-sharepoint-2013.md).
    
  
- **Пользовательский интерфейс.** Три способа отобразить Надстройка SharePoint в SharePoint: как минимум, все надстройки полностью отображаются на веб-странице. При необходимости надстройка может отображаться как часть целого, а также с помощью элемента меню или кнопки ленты. Дополнительные сведения см. в статье [Проектирование пользовательского интерфейса для надстроек SharePoint](ux-design-for-sharepoint-add-ins.md).
    
    > **Примечание**
      > Надстройки SharePoint могут устанавливаться вашими потребителями на многих семействах сайтов на правах аренды или на базе "веб-сайт  веб-сайт". Второй тип надстроек известен как надстройки области клиента. Если вашими потребителями должен использоваться параметр области клиента, можно не добавлять пользовательскую кнопку или часть надстройки. Дополнительные сведения см. в статье  [Сроки аренды и области развертывания надстроек для SharePoint](tenancies-and-deployment-scopes-for-sharepoint-add-ins.md). 

## Архитектурные уровни
<a name="Tiers"> </a>

Надстройка имеет три логических уровня: пользовательский интерфейс, бизнес-логика и доступ к данным. Каждый уровень содержит множество параметров реализации. С другой стороны, конфигурация, сделанная для одного уровня, ограничивает параметры для других уровней. В таблицах ниже описываются некоторые параметры и их использование для удаленных компонентов надстройки и компонентов SharePoint.
  
    
    

**Удаленные компоненты в автоматически размещаемых надстройках:**


|**Уровень**|**Параметры**|**Подходит для**|
|:-----|:-----|:-----|
|Пользовательский интерфейс  <br/> |Страницы ASP.NET в формах ASP.NET или приложение MVC, размещаемые в веб-роли Microsoft Azure.  <br/> |Использование навыков группы разработчиков ASP.NET.  <br/> |
||Страницы HTML 5 с JavaScript.  <br/> |Расширенный пользовательский интерфейс  <br/> |
||PHP или другой тип веб-страницы, размещаемой в облачной службе не Майкрософт.  <br/> |Интеграция приложений не Майкрософт в SharePoint.  <br/> |
||Silverlight в приложении Windows Phone.  <br/> |Доступ с мобильных устройств к данным SharePoint и интеграция с данными географического расположения и передачей уведомлений.  <br/> |
|Бизнес-логика  <br/> |JavaScript на стороне клиента.  <br/> |Логика пользовательского интерфейса и минимальная бизнес-логика.  <br/> Доступ к данным SharePoint через клиентскую объектную модель JavaScript.  <br/> |
||Рабочая роль Microsoft Azure.  <br/> |Функциональность, требующая высокой нагрузки процессора.  <br/> Доступ к данным SharePoint через клиентскую объектную модель .NET Framework.  <br/> |
||Удаленная веб-служба.  <br/> |Функциональность, требующая высокой нагрузки процессора.  <br/> Доступ к данным SharePoint через клиентскую объектную модель .NET Framework.  <br/> |
|Данные  <br/> |SQL Azure.  <br/> |Полнофункциональные реляционные данные.  <br/> |
||Хранение таблицы Microsoft Azure.  <br/> |Параметры приложения и другие метаданные.  <br/> |
||Хранение больших двоичных данных Microsoft Azure.  <br/> |Хранение больших файлов.  <br/> |
||Облачная служба не Майкрософт.  <br/> |Использование источников существующих данных, основанных на платформах не Майкрософт.  <br/> |
||База данных на собственном сервере разработчика.  <br/> |Размещение у поставщика и элемент управления разработчика обособлением аренды.  <br/> |
   

**Компоненты SharePoint: параметры для каждого уровня**


|**Уровень**|**Параметры**|**Подходит для**|
|:-----|:-----|:-----|
|Пользовательский интерфейс  <br/> |Пользовательские представления списков SharePoint 2013 и библиотек на веб-страницах надстройки.  <br/> |Максимальная интеграция с помощью вида и поведения SharePoint.  <br/> |
||Приложение Silverlight, размещенное в веб-части (или внутри тегов <object>) на веб-странице надстройки.  <br/> |Использование существующего интерфейса разработки Silverlight.  <br/> Расширенный пользовательский интерфейс  <br/> |
|Бизнес-логика  <br/> |Рабочий процесс SharePoint.  <br/> |Реализация бизнес-процессов.  <br/> |
||JavaScript на клиентской стороне, дополненный междоменной библиотекой SharePoint.  <br/> |Доступ к данным SharePoint на сайте надстройки.  <br/> Доступ к данным на других веб-сайтах в пределах аренды.  <br/> |
||Удаленный обработчик событий.  <br/> |Обработка событий CRUD в списках и библиотеках SharePoint с помощью внешне размещенной логики.  <br/> |
|Данные  <br/> |Списки SharePoint 2013 и библиотеки, которые запрашиваются через Язык CAML, или LINQ, запросы с помощью одной из клиентских объектных моделей SharePoint.  <br/> |Использование существующей SharePoint и интерфейса разработчиков в .NET Framework.  <br/> |
||Списки и библиотеки SharePoint 2013, запрашиваемые через веб-службу REST/OData SharePoint.  <br/> |Доступ к данным SharePoint с платформ не Майкрософт.  <br/> Использование существующего опыта интерфейса запросов OData.  <br/> |
||Модель службы BCS.  <br/> |Отображение внешних данных в SharePoint в виде списка SharePoint.  <br/> |
   

## Факторы, учитываемые при создании ваших проектных решений
<a name="DecisionFactors"> </a>

Модель Надстройка SharePoint предоставляет достаточно много возможностей для проектирования, поэтому простое дерево решений реализовать невозможно. Далее рассматриваются наиболее важные факторы, необходимые для построения архитектуры Надстройка SharePoint.
  
    
    

- Конечно, самым важным фактором является функциональность, которую необходимо предоставить потребителям, т. е. варианты использования. Например, если ваша надстройка содержит функции, требующие интенсивной работы процессора, например, конвертации файлов видео в другой формат, что может быть поводом для создания надстроек, размещаемых у поставщика, в которых обработка осуществляется на одном из серверов или в рабочей роли Microsoft Azure.
    
  
- Так как один тип надстроек Надстройка SharePoint, а именно с размещением у поставщика, требует от вас (или от ваших потребителей) установки компонентов не SharePoint и усиления обособления клиентов, необходимо рассмотреть вопрос, есть ли у вас оборудование и ИТ-персонал, чтобы сделать это (или планируете ли вы, чтобы это сделали потребители).
    
  
- Кто из потребителей будет этим заниматься  это тоже важный вопрос. Если ваши надстройки будут использоваться внутри компании (то есть, у вас не будет внешних пользователей) или одним пользователем, надстройки, размещаемые у поставщика, значительно легче реализовывать и обслуживать, чем, если бы у вас были внешние пользователи или несколько пользователей, использующих надстройку. Если предполагается открыто продавать надстройку, необходимо решить вопрос, продавать ли ее предприятиям, имеющим учетные записи SharePoint Online или собственные фермы SharePoint, или и тем и другим.
    
  
- Кроме того, вы должны учитывать ваши уже имеющиеся навыки и опыт группы разработчиков. Например, если вы обладаете опытом разработчика ASP.NET, то его можно было бы использовать для создания удаленного веб-приложения и отображения данных списка SharePoint в таблице на странице ASP.NET. С другой стороны, если вы являетесь опытным разработчиков SharePoint, то могли бы использовать пользовательский список SharePoint и страницу сайта, а также выполнить обработку с помощью JavaScript.
    
  

## Дополнительные ресурсы
<a name="AdditionalResources"> </a>


-  [Проектирование надстроек для SharePoint](design-sharepoint-add-ins.md)
    
  
-  [Важные аспекты архитектуры и разработки надстройки SharePoint](important-aspects-of-the-sharepoint-add-in-architecture-and-development-landscap.md)
    
  

