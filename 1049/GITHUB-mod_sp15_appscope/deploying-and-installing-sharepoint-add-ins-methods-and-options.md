---
title: Развертывание и установка надстроек для SharePoint методы и параметры
ms.prod: SHAREPOINT
ms.assetid: d15a74a7-3c10-485a-9885-7ef11aaa0d90
---


# Развертывание и установка надстроек для SharePoint: методы и параметры
Сведения о методах публикации, установки и удаления Надстройка SharePoint.
## Публикация в Магазин Office или каталоге надстроек организации
<a name="MarketOrCatalog"> </a>

Вы можете разместить свою надстройку Надстройка SharePoint в общедоступном Магазин Office или в частном каталоге надстроек организации. Частный каталог надстроек  это специальная коллекция веб-сайтов в веб-приложении SharePoint 2013 (или клиенте SharePoint Online), в которой размещаются библиотеки документов для приложений для SharePoint и приложений для Office. Размещение каталога в собственной коллекции веб-сайтов позволяет администратору веб-приложений или клиентов более легко ограничивать разрешения на доступ в каталог. 



Если надстройку разместить в общедоступном Магазин Office, Microsoft выполняет в нем ряд операций по проверке. Например, проверку действительности и полноты разметки манифеста надстройки, а также того, не содержат ли какие-либо из пакетов решений SharePoint (файлы WSP) запрещенных элементов или функций, область действия которых шире, чем **Web**. Содержимое пакета также проверяется на предмет нежелательных элементов. Если надстройка проходит все проверки, пакет надстройки заносится в файл и подписывается Microsoft. 




> **Примечание**
> При разработке надстройки и её развертывании с помощью Инструменты разработчика Microsoft Office для Visual Studio она устанавливается непосредственно на целевом тестовом сайте SharePoint. Так как надстройка не проходит через Магазин Office, описанная выше проверка не выполняется. 




Размещение Надстройка SharePoint в каталоге надстроек организации не сложнее размещения любого файла в библиотеке документов SharePoint Foundation. Вы заполняете всплывающую форму, в которую вводите локальный URL пакета надстройки и другую информацию, такую как название надстройки. После размещения надстройки в каталоге надстроек организации проводятся те же самые проверочные действия, а надстройки, не прошедшие проверку, помечаются в каталоге как недействительные или недоступные. 



Администраторы клиентов и администраторы веб-приложений SharePoint 2013 могут находить Надстройки SharePoint и приобретать их в общедоступном Магазин Office. Чтобы открыть Магазин Office, администратор должен выбрать команду **Добавить надстройку** на странице **Содержимое веб-сайта**, а затем выбрать **Магазин SharePoint** на странице **Ваши надстройки**. После этого откроется страница **Магазин SharePoint**, на которой администраторы могут находить сведения о приложениях для SharePoint, предлагаемых поставщиками. (Это также можно сделать на сайте office.com.) Надстройки, требующие наличия компонентов, которые не установлены в веб-приложении или клиенте администратора, помечены как недоступные. Например, если приложение требует сервисов Поиск, которые не установлены, надстройка помечается как недоступная. Администраторы могут сортировать, фильтровать или просматривать список надстроек, читать сведения и отзывы о надстройках, а также покупать лицензии на надстройки.



Решив приобрести лицензию, администратор должен принять условия покупки и согласиться с разрешениями, которые должна иметь надстройка для нормальной работы, такими как доступ к чтению списков или полный доступ к коллекции веб-сайтов. 



При покупке одной или более лицензий для надстройки они загружаются в веб-приложение или клиент. Автоматическая загрузка и установка надстройки при покупке лицензии не предусмотрены, хотя администраторы имеют возможность совместить установку с покупкой лицензии.



Пользователи устанавливают надстройки со страницы **Ваши надстройки**. На странице располагаются такие объединенные списки:




- Надстройки SharePoint из каталога надстроек организации (или клиента) веб-приложения.


- Надстройки SharePoint из Магазин Office, на который организация или клиент уже имеют лицензию веб-сайта, или лицензию, которая была присвоена пользователю.


Все надстройки, которые пользователь может установить сразу, находятся в списке и, за немногими исключениями, в списке находятся только надстройки, которые пользователь может установить сразу. Пользователи могут применить фильтр к надстройкам на странице, включив туда только надстройки, находящиеся в каталоге надстроек организации. Если надстройка установлена, она появляется в списке надстроек на странице **Содержимое сайта** веб-сайта, на котором она установлено.




## Установка надстроек для SharePoint
<a name="Installing"> </a>

Владельцы веб-сайтов устанавливают Надстройки SharePoint со страницы **Ваши надстройки**, как было описано ранее в этом разделе. При установке создается экземпляр надстройки. Подробнее об установке надстроек:  [Добавление надстроек для SharePoint на сайт SharePoint 2013](https://technet.microsoft.com/ru-ru/library/fp161231.aspx). 




> **Примечание**
> Иногда в результате временных сбоев в сетевом соединение установка может быть заблокирована. Если по какой-либо причине при установке происходит сбой, инфраструктура инсталляции повторяет попытку три раза. При неудаче в пользовательском интерфейсе появляется отметка об ошибке. Пользователи могут повторить попытку установки позднее. 





## Удаление надстроек для SharePoint
<a name="Uninstalling"> </a>

Владельцы веб-сайта могут удалить экземпляр Надстройка SharePoint с помощью пользовательского интерфейса SharePoint. Удаление экземпляра Надстройки SharePoint чистое, т. е. удаляется все, установленное надстройкой. 



Однако компоненты, используемые надстройкой, которые установлены отдельно от нее, не удаляются. Например, предположим, что у надстройки есть удаленная веб-страница с кнопками, которые создают списки на хост-сайте. Удаление надстройки приведет к удалению плитки надстройки со страницы **Содержимое сайта**, что в свою очередь сделает удаленную страницу недоступной или непригодной для пользователей. Но при этом списки, созданные с надстройкой, не будут удалены. SharePoint не хранит сведения о том, какие списки на хост-сайте были созданы надстройкой, а какие  пользователями в интерфейсе SharePoint, поэтому невозможно удалить списки, созданные надстройкой. В целом, это положительное поведение, так как списки могут содержать данные, которые будут полезны пользователям даже после удаления надстройки, создавшей их.



Если Надстройка SharePoint включает в себя веб-надстройку, то она удаляется. Благодаря этому достигается более полное удаление, чем при систематическом отключении функций и запуске WSP-файла надстройки в режиме отмены.




> **Примечание**
> Когда пользователь удаляет надстройку, она перемещается в корзину первого уровня. Если удалить её из нее, она перемещается в корзину второго уровня. Если надстройка удалена из корзины второго уровня, она полностью удаляется без возможности восстановления. 




Разрешения надстройки после ее удаления или перемещения в корзину также аннулируются согласно следующим правилам:




- разрешения уровня веб-сайта всегда аннулируются;


- если в семействе веб-сайтов отсутствуют другие экземпляры надстройки, разрешения уровня семейства веб-сайтов также аннулируются;


- если в подписке сайта (области клиента) отсутствуют другие экземпляры надстройки, разрешения уровня области клиента также аннулируются.


Веб-служба  [UninstallingEventEndpoint](http://msdn.microsoft.com/library/4194e44b-f2af-1db4-aad5-9b7b511b4348%28Office.15%29.aspx), если она зарегистрирована в манифесте надстройки, выполняется в начале процесса удаления. Это происходит, если надстройка удаляется из корзины второго уровня. Рекомендуется пользоваться веб-службой  [UninstallingEventEndpoint](http://msdn.microsoft.com/library/4194e44b-f2af-1db4-aad5-9b7b511b4348%28Office.15%29.aspx), если вы также пользуетесь веб-службой  [InstalledEventEndpoint](http://msdn.microsoft.com/library/af9f83d8-8325-3ede-d7b0-bb82c0445eb9%28Office.15%29.aspx), и настраивать услугу  [UninstallingEventEndpoint](http://msdn.microsoft.com/library/4194e44b-f2af-1db4-aad5-9b7b511b4348%28Office.15%29.aspx) так, чтобы она отменяла все действия, выполняемые службой [InstalledEventEndpoint](http://msdn.microsoft.com/library/af9f83d8-8325-3ede-d7b0-bb82c0445eb9%28Office.15%29.aspx). Дополнительные сведения см. в статье  [Обработка событий в надстройках SharePoint](handle-events-in-sharepoint-add-ins.md).




## Дополнительные ресурсы
<a name="SP15deployinstallapps_addlresources"> </a>


-  [Публикация надстроек для SharePoint](publish-sharepoint-add-ins.md)


-  [Важные аспекты архитектуры и разработки надстройки SharePoint](important-aspects-of-the-sharepoint-add-in-architecture-and-development-landscap.md)


-  [Процедура обновления надстроек для SharePoint](sharepoint-add-ins-update-process.md)



