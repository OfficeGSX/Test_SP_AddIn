---
title: Строки URL и маркеры в надстройках для SharePoint
ms.prod: SHAREPOINT
ms.assetid: 800ec8cd-a448-46bc-b41e-d4030eeb4048
---


# Строки URL и маркеры в надстройках для SharePoint
Узнайте, какие маркеры URL-адресов доступны для использования в Надстройки SharePoint.
> **Важно!**
> Общие сведения о конструировании URL-адресов в SharePoint 2013 и использовании маркеров в этих URL-адресах см. в статье  [URL-адреса и маркеры в SharePoint 2013](http://msdn.microsoft.com/library/161418d7-8123-4c4e-91a1-97e43c17f0e6%28Office.15%29.aspx). В этой статье описываются маркеры, доступные в Надстройки SharePoint. 
  
    
    


## 
<a name="URLtokens"> </a>

SharePoint 2013 поддерживает использование в Надстройки SharePoint маркеров, приведенных в следующих таблицах.
  
    
    
Маркеры, перечисленные в таблицах в этом разделе, можно использовать в URL-адресах во множестве ситуаций в ходе разработки Надстройки SharePoint, например в дополнительных действиях и ссылках на пользовательские страницы. Некоторые из этих маркеров нельзя использовать в определенных контекстах. Список допустимых маркеров ограничен для начальных страниц надстроек, дополнительных действий на хост-сайтах и свойства веб-частей надстроек  [Src](https://msdn.microsoft.com/library/Microsoft.SharePoint.WebControls.SPAppIFrame.Src.aspx) . Эти случаи вынесены в отдельные столбцы, * **но они не являются единственными областями применения маркеров.*** 
  
    
    
В столбце **StartPage** указано, можно ли использовать маркер в элементе **StartPage** манифеста надстройки. В столбце **Дополнительное действие** указано, можно ли использовать маркер в URL-адресе пользовательского действия на хост-сайте. В столбце **Веб-часть надстройки** указано, можно ли использовать маркер в свойстве [Src](https://msdn.microsoft.com/library/Microsoft.SharePoint.WebControls.SPAppIFrame.Src.aspx) веб-части надстройки.
  
    
    

**Маркеры, которые могут использоваться в начале URL-адреса в Надстройка SharePoint**


|**Маркер**|**Разрешается в**|**StartPage**|**Дополнительное действие**|**Веб-часть надстройки**|**Примечания**|
|:-----|:-----|:-----|:-----|:-----|:-----|
|~appWebUrl  <br/> |URL-адрес сайта надстройки для Надстройка SharePoint.  <br/> |Да  <br/> |Да  <br/> |Да  <br/> |Этот маркер должен использоваться только вне сайта надстройки. Внутри самого сайта надстройки используйте для его URL-адреса маркер **~site**.  <br/> |
|~controlTemplates  <br/> |URL-адрес виртуальной папки ControlTemplates для текущего веб-сайта.  <br/> |Нет  <br/> |Нет  <br/> |Нет  <br/> ||
|~hostUrl  <br/> |URL-адрес хост-сайта.  <br/> |Нет  <br/> |Нет  <br/> |Да  <br/> ||
|~hostLogoUrl  <br/> |URL-адрес логотипа хост-сайта.  <br/> |Нет  <br/> |Нет  <br/> |Нет  <br/> ||
|~layouts  <br/> |URL-адрес виртуальной папки Layouts для текущего веб-сайта.  <br/> |Нет  <br/> |Нет  <br/> |Нет  <br/> ||
|~remoteAppUrl  <br/> |URL-адрес удаленного веб-приложения в Надстройка SharePoint.  <br/> |Да  <br/> |Да для хост-сайтов. Нет для сайтов надстроек.  <br/> |Да  <br/> |Если при разработке надстройки SharePoint используется Инструменты разработчика Microsoft Office для Visual Studio, то **~remoteAppUrl** невозможно использовать в URL-адресах **StartPage**. Тем не менее, если используются Visual Studio и средства, то этот маркер можно использовать для всех размещаемых у поставщика надстроек, и он разрешается при упаковке надстройки средой Visual Studio. В этом случае он скорее является маркером Visual Studio, чем маркером SharePoint. Вне манифеста надстройки этот маркер можно использовать, даже если не используется Инструменты разработчика Microsoft Office для Visual Studio.  <br/> |
|~site  <br/> |URL-адрес текущего веб-сайта.  <br/> |Нет  <br/> |Нет  <br/> |Да  <br/> ||
|~sitecollection  <br/> |URL-адрес родительского семейства сайтов для текущего веб-сайта.  <br/> |Нет  <br/> |Нет  <br/> |Да  <br/> ||
   
Если не указано обратное, перечисленные в следующей таблице маркеры можно использовать в части  *path*  свойства веб-части надстройки [Src](https://msdn.microsoft.com/library/Microsoft.SharePoint.WebControls.SPAppIFrame.Src.aspx) . Столбец **Веб-часть надстройки** относится к их использованию в части значения *query string*  .
  
    
    

**Маркеры, которые могут использоваться внутри URL-адреса**


|**Маркер**|**Разрешается в**|**StartPage**|**Дополнительное действие**|**Веб-часть надстройки**|**Примечания**|
|:-----|:-----|:-----|:-----|:-----|:-----|
|{AppContextToken}  <br/> |Маркер контекста OAuth для надстройки.  <br/> |Нет  <br/> |Нет  <br/> |Нет  <br/> ||
|{AppWebUrl}  <br/> |URL-адрес сайта надстройки в Надстройка SharePoint.  <br/> |Да  <br/> |Да  <br/> |Да  <br/> |Этот маркер должен использоваться только вне сайта надстройки. Внутри самого сайта надстройки используйте для его URL-адреса маркер **{Site}**.  <br/> |
|{ClientTag}  <br/> |Контрольный номер кэша клиента (метка клиента) для текущего веб-сайта.  <br/> |Да  <br/> |Да  <br/> |Да  <br/> ||
|{HostLogoUrl}  <br/> |Эмблема для хост-сайта Надстройка SharePoint.  <br/> |Да  <br/> |Да  <br/> |Да  <br/> ||
|{HostTitle}  <br/> |Название хост-сайта Надстройка SharePoint.  <br/> |Да  <br/> |Да  <br/> |Да  <br/> ||
|{HostUrl}  <br/> |URL-адрес хост-сайта Надстройка SharePoint.  <br/> |Да  <br/> |Да  <br/> |Да  <br/> ||
|{ItemId}  <br/> |Идентификатор элемента в списке или библиотеке (целое значение).  <br/> |Нет  <br/> |Да  <br/> |Нет  <br/> ||
|{ItemUrl}  <br/> |URL-адрес элемента, с которым выполняется действие.  <br/> |Нет  <br/> |Да  <br/> |Нет  <br/> ||
|{Language}  <br/> |Текущий язык и региональные параметры хост-сайта Надстройка SharePoint.  <br/> |Да  <br/> |Да  <br/> |Да  <br/> ||
|{ListId}  <br/> |Идентификатор текущего списка (GUID).  <br/> |Нет  <br/> |Да  <br/> |Нет  <br/> ||
|{ProductNumber}  <br/> |Полный номер версии фермы SharePoint.  <br/> |Да  <br/> |Да  <br/> |Да  <br/> |Пример значения: "15.0.4433.1011".  <br/> |
|{RecurrenceId}  <br/> |Индекс повторения повторяющегося события.  <br/> |Нет  <br/> |Да  <br/> |Нет  <br/> |Этот маркер не поддерживается для контекстных меню элементов списков.  <br/> |
|{RemoteAppUrl}  <br/> |URL-адрес удаленного веб-приложения в Надстройка SharePoint.  <br/> |Да  <br/> |Да  <br/> |Да  <br/> ||
|{Site}  <br/> |URL-адрес текущего веб-сайта.  <br/> |Нет  <br/> |Да  <br/> |Да  <br/> ||
|{SiteCollection}  <br/> |URL-адрес родительского сайта для текущего веб-сайта.  <br/> |Нет  <br/> |Да  <br/> |Да  <br/> ||
|{SiteUrl}  <br/> |URL-адрес текущего веб-сайта.  <br/> |Нет  <br/> |Да  <br/> |Нет  <br/> ||
|{Source}  <br/> |URL-адрес HTTP-запроса.  <br/> |Нет  <br/> |Да  <br/> |Нет  <br/> ||
|{StandardTokens}  <br/> |См. раздел "Замечания".  <br/> |Да  <br/> |Да  <br/> |Да  <br/> |Этот маркер составлен из пяти других маркеров. Сначала он разрешается в  `SPHostUrl={HostUrl}&amp;SPAppWebUrl={AppWebUrl}&amp;SPLanguage={Language}&amp;SPClientTag={ClientTag}&amp;SPProductNumber={ProductNumber}`. Затем разрешается каждый из этих маркеров. Если сайт надстройки отсутствует, то отсутствует и часть  `&amp;SPAppWebUrl={AppWebUrl}`.  <br/> |
   

## Дополнительные ресурсы
<a name="SP15URLstrings_bk_addlresources"> </a>


-  [Расширенная поддержка экстрасети](http://msdn.microsoft.com/library/21d67796-23c5-4339-8f0e-124208d21ab2%28Office.15%29.aspx)
    
  
-  [Получение ссылок на сайты, веб-приложения и другие ключевые объекты](http://msdn.microsoft.com/library/8623ef1d-e3cc-426c-84a3-6379e0ae284f%28Office.15%29.aspx)
    
  
-  [Работа с объектами List и коллекциями](http://msdn.microsoft.com/library/d4167b10-6f1e-49f1-8b22-16ce20012a27%28Office.15%29.aspx)
    
  
-  [Образцы задач объектной модели](http://msdn.microsoft.com/library/94d6898d-6a0f-43a7-ad06-1b27ec6916ea%28Office.15%29.aspx)
    
  

