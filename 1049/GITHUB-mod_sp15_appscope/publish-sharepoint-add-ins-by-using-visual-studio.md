---
title: Публикация надстройки для SharePoint с помощью Visual Studio
keywords: vs.sharepointtools.project.sharepointprojectpropertytab
f1_keywords:
- vs.sharepointtools.project.sharepointprojectpropertytab
ms.prod: SHAREPOINT
ms.assetid: 8137d0fa-52e2-4771-8639-60af80f693bb
---


# Публикация надстройки для SharePoint с помощью Visual Studio
Узнайте, как опубликовать Надстройка SharePoint с помощью Microsoft Visual Studio 2013 или Visual Studio 2012. Если с надстройкой связано веб-приложение, то сначала необходимо развернуть его. Затем, как и для всех Надстройки SharePoint, необходимо упаковать Надстройка SharePoint и опубликовать его. Кроме того, можно отправить надстройку для ее включения в Магазин Office.
## Необходимые условия
<a name="Prereq"> </a>






-  [Microsoft Visual Studio 2013](http://go.microsoft.com/fwlink/?LinkId=517284)

    -или-

     [Visual Studio 2012](https://www.microsoft.com/ru-ru/download/details.aspx?id=30682) и Инструменты разработчика Office для Visual Studio. Чтобы скачать эти инструменты, см. раздел "Инструменты" на [странице загрузки](http://go.microsoft.com/fwlink/?LinkId=234393). (Новый диспетчер публикации недоступен в Visual Studio 2012 и более ранних версиях.)


- Microsoft SharePoint 2013



## Публикация с помощью Visual Studio 2013
<a name="VS2013"> </a>

Если с размещаемым у поставщика Надстройка SharePoint связано веб-приложение, для начала разверните файлы для него. Затем, как и для всех Надстройки SharePoint, запакуйте Надстройка SharePoint и опубликуйте его.




> **Важно!**
> Чтобы обеспечить публикацию значений идентификатора клиента и секрета клиента SharePoint с веб-проектом, что позволит веб-содержимому получать доступ к данным SharePoint, опубликуйте проект Надстройка SharePoint со страницы **Публикация надстройки**. Чтобы открыть эту страницу, вызовите контекстное меню Надстройка SharePoint (не контекстное меню веб-приложения) и выберите команду **Опубликовать**. 





### Этап 1. Развертывание веб-приложения

Обычно с Надстройка SharePoint связано ведущее веб-приложение, которое необходимо развернуть на веб-сервере. Подробнее об использовании мастера веб-публикации см. в статье  [Инструкции. Развертывание проекта веб-приложения с помощью публикации одним щелчком в Visual Studio](http://msdn.microsoft.com/library/dd465337.aspx).




### Открытие страницы публикации надстроек


- В **обозревателе решений** откройте контекстное меню для проекта Надстройка SharePoint и выберите команду **Опубликовать**.

    Откроется страница **публикации надстроек**.



### Выбор или создание профиля


- В списке **Текущий профиль** выберите профиль для импорта или выберите команду **<Создать...>**, чтобы создать профиль.

    В профиле публикации указан сервер, на котором развертывается веб-приложение, учетные данные, необходимые для входа на сервер, развертываемые базы данных (если применимо) и другие параметры развертывания. Вы можете создавать различные профили публикации в соответствии с вашими потребностями. Например, можно создать один профиль для тестирования, а другой для публикации.

    Если выбрать команду **<Создать...>**, появится **мастер создания профиля публикации**. С помощью этого мастера можно импортировать профиль публикации от поставщика услуг размещения сайтов, например Azure, или создать новый профиль, а затем вручную добавить имя сервера, учетные данные и другие параметры. Если создать новый профиль, а не импортировать существующий, потребуется указать значения идентификатора клиента и секрета клиента, как описано в статьях  [Руководство по регистрации надстроек для SharePoint 2013](http://msdn.microsoft.com/library/jj687469.aspx) и [Создание или обновление идентификаторов и секретов клиентов в панели мониторинга продавца Майкрософт](http://msdn.microsoft.com/library/office/jj220036.aspx).

    Если планируется отправить Надстройка SharePoint в Магазин Office, то необходимо использовать значения идентификатора клиента и секрета клиента, созданные на Панели мониторинга продаж. Можно использовать идентификаторы клиентов и значения секрета клиента, созданные с помощью страницы appregnew.aspx в ходе разработки, но для надстроек, отправляемых в Магазин Office, необходимо использовать идентификаторы клиентов и секреты клиентов, полученные из Панели мониторинга продаж. Кроме того, необходимо создать профиль публикации на сайте Azure и импортировать его в Visual Studio, а не создавать профиль в мастере **Создание профиля публикации**. При создании профиля в Azure все параметры на вкладке **Подключение** предоставляются в Visual Studio. Дополнительные сведения об импорте и создании профилей публикации см. в статье [Создание профиля публикации](http://msdn.microsoft.com/library/dd465337.aspx#creating_a_profile).

    > **Совет**
    > Если не удается непосредственно опубликовать веб-содержимое, вы можете создать пакет веб-развертывания, который может развернуть администратор. Чтобы создать пакет веб-развертывания, создайте новый профиль, откройте вкладку **Подключение** и выберите пункт **Пакет веб-развертывания** в списке **Метод публикации**. 

### Развертывание проекта веб-приложения


1. На вкладке **Публикация надстройки** нажмите кнопку **Развернуть проект веб-приложения**.

    Откроется диалоговое окно **Публикация веб-сайта**.


2. Заполните пустые поля на вкладках **Подключение** и **Параметры**.

    Если требуется изменить способ публикации файлов для Надстройка SharePoint, или надстройка использует внешнюю базу данных, откройте вкладку **Параметры**. См. раздел "Настройка вкладки "Параметры"" статьи  [Развертывание проекта веб-приложения с помощью публикации одним щелчком в Visual Studio](http://msdn.microsoft.com/library/dd465337.aspx).


3. Чтобы узнать, какие элементы будут изменены при развертывании веб-приложения, нажмите кнопку **Начало предварительного просмотра** на вкладке **Предварительный просмотр**.


4. Нажмите кнопку **Опубликовать**, чтобы развернуть проект веб-приложения.



### Этап 2. Упаковка надстройки


1. На вкладке **Публикация надстройки** нажмите кнопку **Упаковать надстройку**.

    Откроется мастер **Публикация надстроек для Office и SharePoint**.


2. В текстовом поле **Где размещен ваш веб-сайт?** введите URL-адрес сайта, на котором будут размещены файлы Надстройка SharePoint.

    Необходимо указать адрес, начинающийся с префикса "https". См. статью  [Почему надстройки должны быть защищены с помощью SSL?](http://msdn.microsoft.com/library/jj591603#bk_q7).

    > **Примечание**
    > Веб-сайты WinAzure автоматически предоставляют конечную точку https. Если надстройка публикуется на сайте Магазин Office или в Магазин Office, адрес должен начинаться с префикса "https". Тем не менее, если надстройка публикуется на локальном сайте, необходимо использовать префикс "http". 

    В текстовом поле **Идентификатор клиента надстройки** уже должен появиться идентификатор клиента, введенный в профиле публикации.

    Если до этого момента использовалось замещающее значение идентификатора клиента, то теперь необходимо добавить фактический идентификатор клиента. Эти сведения встроены в APP-пакет и позволяют веб-содержимому связываться с SharePoint на динамическом сайте.


3. Нажмите кнопку **Готово**.

    Visual Studio создаст файлы, необходимые для публикации Надстройка SharePoint, а затем откроет конечную папку публикации. Сведения об установке надстроек см. в статье  [Установка надстроек SharePoint 2013 и управление ими](http://technet.microsoft.com/library/fp161232.aspx).



### Этап 3. Публикация Надстройка SharePoint в Магазин Office

Для отправки Надстройка SharePoint в Магазин Office выполните указанные ниже действия.




1. На странице **Публикация надстройки** нажмите кнопку **Посетить панель мониторинга продаж** и войдите в свою учетную запись панели мониторинга продаж Майкрософт.

    Дополнительные сведения см. в статье  [Отправка надстроек Office и SharePoint, а также веб-приложений для Office 365 в Магазин Office](http://msdn.microsoft.com/library/ff075782-1303-4517-91cc-b3d730e9b9ae%28Office.15%29.aspx).


2. Выберите пункт **добавить новое приложение**, введите необходимые данные и отправьте надстройку в Магазин Office. Дополнительные сведения см. в статье  [Отправка надстроек Office и SharePoint и приложений для Office 365 в Магазин Office с помощью Панели мониторинга продаж](http://msdn.microsoft.com/library/260ef238-0be4-42d6-ba15-1249a8e2ff12%28Office.15%29.aspx).



## Публикация с помощью Visual Studio 2012
<a name="VS2012"> </a>

Когда Надстройка SharePoint будет готово к упаковке, откройте мастер **публикации надстроек Office**, который подготовит файлы Надстройка SharePoint к публикации.




### Этап 1. Упаковка Надстройка SharePoint


1. В **обозревателе решений** откройте контекстное меню для проекта Надстройка SharePoint и выберите команду **Опубликовать**.

    Запустится мастер **публикации надстроек Office**. Страницы мастера зависят от типа Надстройка SharePoint, которое вы упаковываете. Для надстройки с размещением в SharePoint появляется только страница **Сводка**. Для надстройки, размещаемой у поставщика, также отображаются страницы **Профиль** и **Размещение**.


2. Если Надстройка SharePoint размещается у поставщика, укажите имя профиля публикации в списке **Выбор профиля для публикации** и нажмите кнопку **Далее**.

    В профиле публикации сохраняются сведения, введенные вами на странице **Размещение**.


3. В списке **Место размещения веб-сайта** укажите URL-адрес веб-приложения, в котором будет размещаться Надстройка SharePoint.


4. В полях в разделе **Удостоверение надстройки** укажите идентификатор клиента и секрет клиента для надстройки, а затем нажмите кнопку **Далее**.

    См. статью  [Авторизация и проверка подлинности для надстроек в SharePoint 2013](authorization-and-authentication-of-sharepoint-add-ins.md).


5. Для всех типов Надстройки SharePoint установите флажок **Открыть папку выходных данных после успешной упаковки**, если он еще не установлен, и нажмите кнопку **Готово**.

    Visual Studio создает все файлы, необходимые для публикации Надстройка SharePoint. Эти файлы находятся в подпапке  `app.Publish` в папке выходных данных проекта (например, `%UserProfile%\\Documents\\Visual Studio 2012\\Projects\\MyApp\\bin\\Debug\\app.publish`). В ней содержится APP-файл Надстройка SharePoint и несколько файлов веб-приложения (если Надстройка SharePoint размещается в облаке). Все Надстройки SharePoint включают APP-файл, представляющий собой манифест надстройки для публикации Надстройка SharePoint. Надстройки SharePoint с размещением у поставщика также включают файлы для публикации ведущего веб-приложения.



### Этап 2. Публикация веб-приложения

Если Надстройка SharePoint размещается у поставщика, то с ним связано веб-приложение, которое необходимо опубликовать на веб-сервере. Visual Studio создает пакет развертывания и сценарий для выполнения этой задачи.



Пакет развертывания для проекта веб-приложения содержится в сжатом файле (ZIP) в папке  `app.publish`. Помимо ZIP-файла, в папке  `app.publish` находятся следующие файлы.





|**Файл**|**Описание**|
|:-----|:-----|
| _ProjectName_.deploy.cmd  <br/> |Это пакетный файл командной строки, который вызывает средство веб-развертывания, что позволяет упростить установку пакета с помощью командной строки.  <br/> |
| _ProjectName_.SetParameters.xml  <br/> |Этот файл содержит параметры, которые передаются в средство веб-развертывания при использовании файла deploy.cmd для установки пакета. Настройки пакета Visual Studio определяют значения по умолчанию для всех параметров. Вы можете изменить эти значения, например, если нужно установить веб-приложение на нескольких серверах и использовать разные параметры для каждого из них.  <br/> |
| _ProjectName_.SourceManifest.xml  <br/> |Этот файл содержит параметры, которые Visual Studio передает в средство веб-развертывания и которые это средство использует для создания веб-пакета. Этот файл требуется средству веб-развертывания только для создания пакета. Он не используется при установке пакета.  <br/> |
 
Пошаговые инструкции см. в статье  [Как установить пакет развертывания с помощью файла deploy.cmd, созданного в Visual Studio](http://go.microsoft.com/fwlink/?LinkID=254954)




### Этап 3. Публикация Надстройка SharePoint
<a name="Publish"> </a>

Чтобы опубликовать Надстройка SharePoint, отправьте файл манифеста надстройки (APP-файл) в Магазин Office, каталог надстроек Office, SharePoint, файловый ресурс или каталог Exchange. Манифест надстройки находится в папке  `app.publish`, например  `%UserProfile%\\Documents\\Visual Studio 2012\\Projects\\MyApp\\bin\\Debug\\app.publish`. Дополнительные сведения о публикации Надстройка SharePoint см. в статье  [Авторизация и проверка подлинности для надстроек в SharePoint 2013](authorization-and-authentication-of-sharepoint-add-ins.md).




## Дополнительные ресурсы
<a name="Additional"> </a>


-  [Публикация надстроек для SharePoint](publish-sharepoint-add-ins.md)


-  [Публикация надстройки Office](http://msdn.microsoft.com/library/7f3ae6a0-06e9-438c-8899-bd9f605e6d9e%28Office.15%29.aspx)



