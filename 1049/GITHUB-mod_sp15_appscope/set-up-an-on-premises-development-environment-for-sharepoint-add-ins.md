---
title: Настройка локальной среды разработки надстроек SharePoint
ms.prod: SHAREPOINT
ms.assetid: b0878c12-27c9-4eea-ae3b-7e79e5a8838d
---


# Настройка локальной среды разработки надстроек SharePoint
Сведения о настройке среды разработки, специально предназначенной для создания Надстройки SharePoint в случае локальной установки SharePoint.
## Установка операционной системы для среды разработки Надстройки SharePoint
<a name="bk_installOS"> </a>

По сравнению с требованиями к рабочей среде, требования к среде разработки менее строгие, а их выполнение менее затратно. Поэтому в инструкциях, приведенных в этом разделе, нет сведений об установке рабочей среды. В статьях  [Обзор установки и настройки SharePoint 2013](http://technet.microsoft.com/ru-ru/library/ee667264%28v=office.15%29),  [Требования к оборудованию и программному обеспечению для SharePoint 2013](http://technet.microsoft.com/ru-ru/library/cc262485%28v=office.15%29) и [Настройка среды для надстроек SharePoint](http://technet.microsoft.com/ru-ru/library/fp161236%28office.15%29.aspx) можно найти инструкции по настройке рабочей среды для SharePoint.



Во всех средах разработки для установки и запуска SharePoint необходимо использовать компьютер с ЦП, поддерживающим архитектуру x64, и с ОЗУ не менее, чем на 16 ГБ. Рекомендуется ОЗУ на 24 ГБ.



В зависимости от конкретных требований и бюджета можно выбрать какой-либо из следующих вариантов.




- Установка SharePoint в Windows Server 2008 R2 64-разрядной версии с пакетом обновления 1 или в Windows Server 2012.


- Использование Microsoft Hyper-V и установка SharePoint на виртуальной машине под управлением гостевой ОС Windows Server 2008 R2 64-разрядной версии с пакетом обновления 1 или Windows Server 2012. Руководство по настройке виртуальной машины Microsoft Hyper-V для SharePoint см. в статье  [Использование рекомендованных конфигураций виртуальных машин SharePoint 2013 и среды Hyper-V](http://technet.microsoft.com/ru-ru/library/ff621103%28v=office.15%29.aspx).



> **Примечание**
> Установка SharePoint поддерживается только в ОС Windows Server 2008 R2 64-разрядной версии с пакетом обновления 1 или в Windows Server 2012. Если вы хотите разрабатывать Надстройки SharePoint для SharePoint в Windows 7 или Windows 8, можно зарегистрироваться на Сайте разработчика Office 365 и разрабатывать надстройки удаленно. 





## Установка обязательных компонентов для операционной системы и SharePoint
<a name="bk_prereqsOS"> </a>


1. Запустите средство PrerequisiteInstaller.exe, включенное в ваши установочные файлы.


2. Запустите средство Setup.exe, включенное в ваши установочные файлы.


3. Примите условия лицензионного соглашения на использование программного обеспечения Майкрософт.


4. На странице **выбора варианта установки** выберите вариант **Автономная**.

   **Рисунок 1. Выбор варианта установки**



!\[Тип сервера установки SharePoint 2013](images/SP15_app_ServerType.gif)





5. Если во время установки возникают какие-либо ошибки, просмотрите файл журнала. Чтобы найти его, откройте окно командной строки и введите следующую команду. Ссылка на файл журнала появляется также после завершения установки.

 ```

cd %temp%
dir /od *.log
 ```

6. После завершения установки вам будет предложено запустить мастер настройки продуктов и технологий SharePoint.

    > **Примечание**
      > Если установка выполняется на компьютере, который присоединен к домену, но не подключен к контроллеру домена, работа мастера настройки продуктов и технологий SharePoint может завершиться с ошибкой. В случае возникновения ошибки подключитесь к контроллеру домена напрямую или с помощью VPN-подключения, либо выполните вход с помощью локальной учетной записи с правами администратора на компьютере. 
7. После завершения работы мастера настройки появится страница **Выбор шаблона** нового сайта SharePoint. На этой странице выберите шаблон **Сайт разработчика**. Надстройки SharePoint с помощью Visual Studio можно разворачивать только на Сайте разработчика.

   **Рисунок 2. Выбор шаблона сайта на странице**



!\[Страница шаблонов сайта](images/SP15_appChooseSiteTemplate.gif)






## Настройка служб в SharePoint для межсерверного использования надстройки
<a name="Servertoserver"> </a>

На этом этапе службы в SharePoint настраиваются для межсерверного использования надстроек. Это позволяет создавать размещаемые у поставщиков надстройки с высоким уровнем доверия в вашей среде. Дополнительные сведения о создании таких надстроек см. в статье  [Создание надстроек с высоким уровнем доверия для SharePoint](create-high-trust-sharepoint-add-ins.md).




1. Убедитесь, что настроены служба управления приложениями и приложение профилей пользователей (эта служба называется службой управления приложениями, так как изначально Надстройки SharePoint назывались "приложениями для SharePoint"). Для этого выполните следующие действия:

1. В **центре администрирования** в разделе **Управление приложениями** выберите пункт **Управление приложениями-службами**.


2. На странице **Приложения-службы** убедитесь в том, что запущены следующие службы:

  - приложение-служба профилей пользователей;


  - служба управления приложениями.


3. В разделе **Управление приложениями** выберите пункт **Управление службами на сервере**. 


4. На странице **Службы на сервере** убедитесь в том, что запущены следующие службы:

  - Служба профилей пользователей 


2. Убедитесь в том, что в **приложении-службе профилей пользователей** создан по крайней мере один профиль. Для этого сделайте следующее.

1. В **центре администрирования** в разделе **Управление приложениями** выберите пункт **Управление приложениями-службами**.


2. Затем выберите пункт **Приложение-служба профилей пользователей**.


3. На странице **Служба управления профилями: приложение-служба профилей пользователей** в разделе **Люди** выберите пункт **Управление профилями пользователей**.


4. На странице **Управление профилями пользователей** нажмите кнопку **Создать профили**.


5. На странице **Добавление профиля пользователя** введите имя своей учетной записи и адрес электронной почты.


6. Нажмите кнопку **Сохранить и закрыть**.

    > **Примечание**
      > Если появится сообщение о том, что профиль, который вы пытаетесь создать, уже существует, нажмите кнопку **Отмена и возврат**. 
7. Вернувшись на страницу **Управление профилями пользователей**, вы должны увидеть сообщение **Общее число профилей: 1**.



## Установка Visual Studio и Инструменты разработчика Office для Visual Studio
<a name="SP15Appdevonprem_bk_installVS"> </a>


- Если вы еще не установили **Visual Studio** 2013 или более поздней версии, сделайте это согласно инструкциям на странице [Install Visual Studio](http://msdn.microsoft.com/library/da049020-cfda-40d7-8ff4-7492772b620f.aspx). Мы рекомендуем использовать  [последнюю версию из Центра загрузки Майкрософт](https://www.visualstudio.com/downloads/download-visual-studio-vs).


- Visual Studio включает в себя **Инструменты разработчика Microsoft Office для Visual Studio**, но иногда выход новой версии инструментов не совпадает с выходом обновлений Visual Studio. Чтобы убедиться, что вы используете последнюю версию инструментов, запустите [установщик Инструментов разработчика Office для Visual Studio 2013](http://aka.ms/OfficeDevToolsForVS2013) или [установщик Инструментов разработчика Office для Visual Studio 2015](http://aka.ms/OfficeDevToolsForVS2015).



### Подробное ведение журнала в Visual Studio

Выполните следующие шаги, если хотите включить подробное ведение журнала.




1. Откройте реестр и перейдите к разделу **HKEY_CURRENT_USER\\Software\\Microsoft\\VisualStudio\\ _nn.n_\\SharePointTools**, где _nn.n_  это версия Visual Studio, например 12.0 или 14.0.


2. Добавьте ключ DWORD под названием **EnableDiagnostics**.


3. Присвойте ключу значение **1**.


Путь реестра изменится в будущих версиях Visual Studio.




## Настройка изолированного домена надстроек в SharePoint
<a name="SP15appdevonprem_bk_configure"> </a>

Ознакомьтесь со статьей  [Хост-сайты, сайты надстройки и изолированный домен](host-webs-add-in-webs-and-sharepoint-components-in-sharepoint-2013.md#IsolatedDomain) до выполнения какого-либо действия в этом разделе.



Требуется создать изолированный домен в вашей тестовой ферме SharePoint. Кроме того, для установки SharePoint требуется общий домен с заголовком узла с подстановочными знаками, где можно выполнять подготовку надстроек, размещаемых в SharePoint.



В целях разработки можно изменить свой файл Hosts при необходимости, чтобы сделать возможной маршрутизацию с компьютера разработки к тестовому экземпляру Надстройка SharePoint. Visual Studio изменяет файл Hosts автоматически при создании и развертывании надстройки. 




> **Примечание**
> Для рабочих ферм необходимо создать стратегию маршрутизации DNS в интрасети и, возможно, настроить брандмауэр. Дополнительные сведения о создании и настройке рабочей среды для Надстройки SharePoint см. в статье  [Установка надстроек SharePoint и управление ими](http://technet.microsoft.com/ru-ru/library/fp161232%28office.15%29.aspx). 




Выполните действия из следующей процедуры для создания изолированного домена надстроек.




> **Примечание**
> Все эти действия необходимо выполнять от имени администратора фермы, а командную строку и командную консоль SharePoint необходимо запускать от имени администратора. 





### Создание изолированного домена надстроек на компьютере разработки


1. Убедитесь, что службы spadmin и sptimer запущены, открыв командную строку и введя следующие команды.

 ```

net start spadminv4
net start sptimerv4
 ```

2. Создайте изолированный домен надстройки, запустив командную консоль SharePoint от имени администратора и выполнив следующую команду. Замените  _contosoaddins.com_ доменом вашей надстройки. Это *не*  должен быть поддомен ведущего домена SharePoint. В противном случае потеряется большинство преимуществ безопасности изолированных доменов надстроек. Например, если имя несущего домена contoso.com, не используйте addins.contoso.com в качестве домена надстроек.

 ```

Set-SPAppDomain "contosoaddins.com"
 ```

3. Обеспечьте запуск служб SPSubscriptionSettingsService и AppManagementServiceInstance, введя в командной консоли SharePoint следующую команду.

 ```
  Get-SPServiceInstance | where{$_.GetType().Name -eq "AppManagementServiceInstance" -or $_.GetType().Name -eq "SPSubscriptionSettingsServiceInstance"} | Start-SPServiceInstance
 ```

4. Убедитесь, что службы SPSubscriptionSettingsService и AppManagementServiceInstance работают, введя в командной консоли SharePoint следующую команду. Результат выполнения команды покажет, подключена ли каждая служба.

 ```
  Get-SPServiceInstance | where{$_.GetType().Name -eq "AppManagementServiceInstance" -or $_.GetType().Name -eq "SPSubscriptionSettingsServiceInstance"}
 ```

5. Необходимо указать учетную запись, в которой будут выполняться экземпляры служб SPSubscriptionService и AppManagementServiceInstance. Это должна быть учетная запись SPManagedAccount. Чтобы создать учетную запись SPManagedAccount, введите в командной консоли SharePoint следующую команду (вам будет предложено указать имя пользователя и домен учетной записи, а также пароль).

 ```
  $account = New-SPManagedAccount
 ```

6. Укажите параметры учетной записи, пула приложений и базы данных для служб SPSubscriptionService и AppManagementServiceInstance, введя следующий код в командной консоли SharePoint. Если в предыдущем действии была создана учетная запись SPManagedAccount, используйте здесь ее имя.

 ```
  $account = Get-SPManagedAccount "domain\\user"
$appPoolSubSvc = New-SPServiceApplicationPool -Name SettingsServiceAppPool -Account $account
$appPoolAppSvc = New-SPServiceApplicationPool -Name AppServiceAppPool -Account $account
$appSubSvc = New-SPSubscriptionSettingsServiceApplication -ApplicationPool $appPoolSubSvc -Name SettingsServiceApp -DatabaseName SettingsServiceDB 
$proxySubSvc = New-SPSubscriptionSettingsServiceApplicationProxy -ServiceApplication $appSubSvc
$appAppSvc = New-SPAppManagementServiceApplication -ApplicationPool $appPoolAppSvc -Name AppServiceApp -DatabaseName AppServiceDB
$proxyAppSvc = New-SPAppManagementServiceApplicationProxy -ServiceApplication $appAppSvc

 ```

7. Укажите префикс надстройки (см.  [Хост-сайты, сайты надстройки и изолированный домен](host-webs-add-in-webs-and-sharepoint-components-in-sharepoint-2013.md#IsolatedDomain)), введя в командной консоли SharePoint приведенный ниже код.

 ```

Set-SPAppSiteSubscriptionName -Name "add-in" -Confirm:$false
 ```

 **Выполните следующую процедуру, только если в вашей среде используется прокси-сервер.** После создания изолированного домена надстроек выполните действия, приведенные в следующей процедуре, чтобы добавить этот домен в список обхода в Internet Explorer. Это гарантирует, что вы сможете переходить к этому домену после развертывания надстройки, размещенной в SharePoint, или надстройки, размещенной у поставщика, которая содержит сайт надстройки.




### Добавление изолированного домена надстроек в список обхода в Internet Explorer


1. В Internet Explorer перейдите в пункт **Сервис**.


2. Выберите пункт **Свойства браузера**.


3. На вкладке **Подключения** нажмите кнопку **Настройка сети**.


4. Снимите флажок **Автоматическое определение параметров**.


5. Установите флажок **Использовать прокси-сервер для локальных подключений**.


6. Нажмите кнопку **Дополнительно**, а затем добавьте *.Ваш_домен_надстроек.com в список **Исключения**.


7. Нажмите кнопку **ОК**.


8. Нажмите кнопку **ОК**, чтобы закрыть диалоговое окно **Настройка локальной сети**.


9. Нажмите кнопку **ОК**, чтобы закрыть диалоговое окно **Свойства браузера**.


Сведения о вариантах развертывания надстроек см. в статье  [Развертывание и установка надстроек для SharePoint: методы и параметры](deploying-and-installing-sharepoint-add-ins-methods-and-options.md).




> **Совет**
> После развертывания размещаемой в SharePoint надстройки в вашей установке при попытке запуска этого приложения вам может предлагаться войти со своими учетными данными. Для избавления от таких предложений следуйте инструкциям из статьи  [При просмотре веб-сайта, использующего встроенную проверку подлинности и размещенного на сервере IIS 5.1 или более поздней версии, появляется сообщение об ошибке 401.1](http://support.microsoft.com/kb/896861/ru-ru). 





## Дополнительные ресурсы
<a name="SP15SetupSPO365_bk_addlresources"> </a>


-  [Надстройки SharePoint](sharepoint-add-ins.md)


-  [Знакомство с созданием надстроек SharePoint с размещением у поставщика](get-started-creating-provider-hosted-sharepoint-add-ins.md)


-  [Знакомство с созданием надстроек SharePoint с размещением в SharePoint](get-started-creating-sharepoint-hosted-sharepoint-add-ins.md)







