---
title: Изучите структуру манифеста надстройки и пакет надстройки для SharePoint
ms.prod: SHAREPOINT
ms.assetid: 7cd5850f-cbf3-48d2-bcb7-59b8f4ed0e63
---


# Изучите структуру манифеста надстройки и пакет надстройки для SharePoint
Ознакомьтесь со структурой пакета надстройки и файла манифеста надстройки SharePoint.
## Структура пакета надстройки SharePoint
<a name="Package"> </a>

Пакет надстройки SharePoint  это файл с расширением APP, который соответствует  [новому стандарту упаковки данных (OPC)](http://msdn.microsoft.com/ru-ru/magazine/cc163372.aspx). Пакет содержит следующие элементы.
  
    
    

- **Манифест надстройки.** Это обязательный файл с именем appmanifest.xml. Он сообщает SharePoint 2013 некоторые важные свойства надстройки, такие как название и необходимые для запуска разрешения. Дополнительные сведения о содержимом этого файла можно найти в разделе [Файл манифеста надстройки для SharePoint](#AppManifest).
    
  
- **Пакеты решений SharePoint.** Надстройка может дополнительно включать пакет решений SharePoint (WSP-файл), содержащий компоненты сайта надстройки. Эти компоненты могут включать страницы, экземпляры списков, представления, документы, компоненты на уровне **Web** и другие компоненты SharePoint 2013. (Дополнительные сведения о том, какие компоненты SharePoint могут быть включены в надстройку SharePoint, можно найти в статье [Типы компонентов SharePoint, которые могут находиться в надстройке для SharePoint](host-webs-add-in-webs-and-sharepoint-components-in-sharepoint-2013.md#TypesOfSPComponentsInApps).) WSP-файл может также содержать Надстройки Office. Компоненты из WSP-файла разворачиваются на сайте надстройки. Пример пакета надстройки, включающего пакет решений SharePoint, можно найти в статье  [Создание надстроек с размещением у поставщика, которые включают в себя пользовательский список SharePoint и тип контента](create-a-provider-hosted-add-in-that-includes-a-custom-sharepoint-list-and-conte.md).
    
  
- **Компоненты хост-сайта с дополнительными действиями или веб-частями надстройки.** В дополнение к компонентам SharePoint 2013, которые разворачиваются на сайте надстройки, Надстройка SharePoint может также разворачивать одно или несколько дополнительных действий (элементов контекстного меню или расширений ленты) на хост-сайте. Это выполняется путем включения в пакет надстройки компонента, не входящего в WSP-файл пакета и разворачивающего компоненты, которые попадут на хост-сайт. Этот "свободный" компонент называется компонентом хост-сайта. Веб-части надстройки разворачиваются на хост-сайте таким же образом. Компонент хост-сайта состоит из стандартного файла SharePoint 2013 feature.xml и одного или нескольких связанных файлов elements.xml. Например, файл elements.xml для дополнительного действия содержит разметку **CustomAction** для этого действия. Он также может включать разметку для веб-частей надстройки. В компоненте хост-сайта могут быть только эти два вида компонентов. Такие компоненты хост-сайта не перечисляются в манифесте надстройки. Однако они являются "частями" в контексте OPC, и существует явное отношение OPC между манифестом надстройки и каждым из этих файлов. Пример пакета надстройки, в котором имеется компонент хост-сайта, можно найти в статье [Выполнение пользовательских действий для развертывания надстроек для SharePoint](create-custom-actions-to-deploy-with-sharepoint-add-ins.md).
    
    > [!Примечание]
      > Администраторы клиента могут выполнять пакетную установку надстройки SharePoint на несколько веб-сайтов. Надстройка, установленная таким образом, называется надстройкой уровня **Tenant**. Если надстройка устанавливается не пакетно, а по отдельности на каждый веб-сайт, то это надстройка на уровне **Web**. Если компонент хост-сайта включает расширения ленты или веб-части надстройки, то при пакетной установке надстройки они не разворачиваются на хост-сайтах, так что только элементы контекстного меню разворачиваются с надстройками на уровне клиента. Уровень надстройки не должен конфликтовать с уровнем компонента. Уровень компонента определяет, где разворачиваются элементы компонента. Возможные уровни  **Farm**, **WebApplication**, **Site** (т. е. семейство сайтов) и **Web**. Для компонентов в надстройках SharePoint (как компонентов хост-сайта, так и компонентов в WSP-файле пакета надстройки) разрешен только вариант **Web**. Уровень надстройки относится к уровню, на котором устанавливается надстройка. Возможные уровни  **Web**, когда надстройка устанавливается на одном или нескольких веб-сайтах по очереди, и **Tenant**, когда выполняется пакетная установка надстройки на несколько веб-сайтов в области клиентов пользователя. Дополнительные сведения об уровнях **Tenant** и **Web** можно найти в статье [Сроки аренды и области развертывания надстроек для SharePoint](tenancies-and-deployment-scopes-for-sharepoint-add-ins.md). 
- **Файлы ресурсов (RESX-файлы) для локализации.** Это составляющие манифеста надстройки для локализации, которые включают название надстройки и составляющие компонентов хост-сайта в пакете надстройки. (Отдельные части пакета надстройки, находящиеся внутри собственных пакетов, таких как WSP-файлы, пакеты Веб-сайты Azure и манифесты надстройка, имеют свои собственные процессы локализации, которые применяются точно так же, как если бы элементы, о которых идет речь, не были частью надстройки SharePoint.) Пример пакета надстройки, содержащего RESX-файлы для компонента хост-сайта, можно найти в статье [Локализация надстроек для SharePoint](localize-sharepoint-add-ins.md).
    
  
- **Манифесты надстроек Office.** При необходимости в пакете может быть один или несколько манифестов надстроек Office, при этом каждый пакет  Надстройка Office. Эта часть может быть включена в пакет надстройки, только если надстройку планируется отправить в корпоративный каталог надстроек SharePoint 2013, а не в общедоступный магазин. Дополнительные сведения можно найти в статье [Публикация надстроек для SharePoint](publish-sharepoint-add-ins.md).
    
  

## Файл манифеста надстройки для SharePoint
<a name="AppManifest"> </a>

Каждая надстройка SharePoint включает файл appmanifest.xml. Файл appmanifest.xml сообщает SharePoint, что он должен знать о надстройке и задает наиболее важные свойства надстройки. Далее приводятся некоторые элементы, которые задаются в манифесте.
  
    
    

- Внутреннее имя, идентификатор продукта и версия надстройки.
    
  
- URL-адрес начальной страницы, которая открывается при запуске надстройки. Это может быть страница на сайте надстройки, страница в облаке или страница на веб-сервере независимого поставщика ПО.
    
    > [!Примечание]
      > В ряде случаев могут существовать ограничения на типы файлов, указываемых в элементе **StartPage**. Дополнительные сведения можно найти в разделе  [Элемент StartPage (PropertiesDefinition complexType) (Manifest SharePoint Add-in)](http://msdn.microsoft.com/library/3092674c-a6c3-9021-3d7e-e716562a4a4f%28Office.15%29.aspx). > При объединении нескольких параметров запроса в значении **StartPage** необходимо использовать кодированный амперсанд " `&amp;amp;`" вместо " `&amp;`" или двоеточия, чтобы указать их вместе. 
- Другие свойства надстройки. Сюда входит название и поддерживаемые надстройкой языки (оба параметра обязательные), URL-адреса служб, которые обрабатывают события после установки, после обновления и до удаления, и шаблон сайта, который должен использоваться при создании сайта надстройки.
    
  
- Запросы разрешений, необходимых надстройке для доступа к ресурсам SharePoint вне сайта надстройки.
    
  
- Идентификация субъекта надстройки в целях проверки подлинности и авторизации. Это субъект, который предоставляет разрешения. Для надстроек с размещением в SharePoint этот элемент не нужен.
    
  
- Список обязательных компонентов (если таковые имеются), которые должны быть доступны, чтобы можно было установить надстройку. Например, может требоваться установка, лицензирование и активация определенных компонентов или служб.
    
  

> [!Примечание]
> Файл манифеста надстройки  единственный обязательный элемент в пакете надстройки, и не все элементы в вышеприведенном списке должны обязательно входить в этот файл. 
  
    
    

Дополнительные сведения о разметке манифеста надстройки можно найти в разделе  [Справочник по схеме для манифестов SharePoint Add-ins](http://msdn.microsoft.com/library/1f8c5d44-3b60-0bfe-9069-1df821220691%28Office.15%29.aspx). Эта статья не заменяет сведения из указанного раздела, в том числе сведения об обязательных элементах и атрибутах. Обратите внимание также на то, что схема манифестов надстроек SharePoint отличается от схемы манифестов надстроек Office. Дополнительные сведения можно найти в разделе  [Справка по схеме для приложений для манифестов Office (версия 1.1)](http://msdn.microsoft.com/library/7e0cadc3-f613-8eb9-57ef-9032cbb97f92%28Office.15%29.aspx).
  
    
    
Далее приводится пример файла appmanifest.xml. Обратите внимание, что в этом примере начальной страницей надстройки является страница ASP.NET, находящаяся на удаленном сервере, а не страница сайта SharePoint. URL-адрес для этой страницы включает строку запроса, которая передает в удаленное веб-приложение URL-адрес хост-сайта. Часть "{HostUrl}" строки является маркером, который разрешается при запуске надстройки. Надстройка запрашивает разрешение на запись во все списки на хост-сайте. Субъектом надстройки, которому необходимо предоставить это разрешение, является удаленное веб-приложение.
  
    
    
В манифесте надстройки необходимо использовать либо элемент **SupportedLocales**, либо элемент **SupportedLanguages**. Элемент **SupportedLanguages** устарел и заменяется элементом **SupportedLocales**. Элемент **SupportedLanguages** будет работать даже после выпуска, однако следует воздерживаться от его использования. Дополнительные сведения об этих элементах можно найти в статьях [Элемент SupportedLocales (PropertiesDefinition complexType) (Manifest SharePoint Add-in)](http://msdn.microsoft.com/library/49bde91a-8d7a-be17-4c91-82c9c19f0f61%28Office.15%29.aspx) и [Элемент SupportedLanguages (PropertiesDefinition complexType) (Manifest SharePoint Add-in)](http://msdn.microsoft.com/library/7a8da886-5731-9abd-2911-5cd268bba4cf%28Office.15%29.aspx).
  
    
    

> [!Примечание]
> Значения атрибута **Scope** элемента **AppPermissionRequest** структурированы как URI, но фактически это строковые литералы. Никакая часть значения **Scope** в следующем примере не является заполнителем. Дополнительные сведения о разрешениях можно найти в статье [Разрешения для надстроек в SharePoint 2013](add-in-permissions-in-sharepoint-2013.md). 
  
    
    




```XML

<?xml version="1.0" encoding="utf-8" ?>
<App xmlns="http://schemas.microsoft.com/sharepoint/2012/app/manifest"
     ProductID="{4a07f3bd-803d-45f2-a710-b9e944c3396e}"
     Version="1.0.0.0"
     SharePointMinVersion="15.0.0.0"
     Name="MySampleApp"
>
  <Properties>
    <Title>My Sample App</Title>
    <StartPage>http://MyRemoteWebApplicationServer/default.aspx/?SPHostUrl={HostUrl}</StartPage>
    <SupportedLocales>
      <SupportedLocale CultureName="en-US" />
    </SupportedLocales>        
  </Properties>

  <AppPermissionRequests>
    <AppPermissionRequest Scope="http://sharepoint/content/sitecollection/web/list" Right="Write"/>
  </AppPermissionRequests>

  <AppPrincipal>
    <RemoteWebApplication ClientId="1ee82b34-7c1b-471b-b27e-ff272accd564" />
  </AppPrincipal>
</App>

```


### Маркеры URL-адресов в манифесте надстройки

SharePoint 2013 предоставляет несколько маркеров, которые можно использовать в элементе **StartPage** и в других местах надстроек и их компонентов, чтобы представлять информацию, которая не известна до запуска надстройки. Инфраструктура SharePoint 2013 разрешает эти маркеры. Одни маркеры используются в начале URL-адреса, а другие можно использовать в URL-адресе в качестве значения параметра запроса. Эти маркеры и некоторое количество других также можно использовать во многих контекстах разработки SharePoint 2013. Подробное описание всех этих маркеров и их использования можно найти в статье [Строки URL и маркеры в надстройках для SharePoint](url-strings-and-tokens-in-sharepoint-add-ins.md). Подробные сведения об остальных маркерах и URL-адресах в SharePoint 2013 можно найти в статье  [URL-адреса и маркеры в SharePoint 2013](http://msdn.microsoft.com/library/161418d7-8123-4c4e-91a1-97e43c17f0e6%28Office.15%29.aspx).
  
    
    

> [!Примечание]
> Эти маркеры не используются в атрибуте **Scope** элемента **AppPermissionRequest**. 
  
    
    


## Дополнительные ресурсы
<a name="SP15Exploreappmanifest_bk_addlresources"> </a>


-  [Разработка надстроек для SharePoint](develop-sharepoint-add-ins.md)
    
  
-  [Важные аспекты архитектуры и разработки надстройки SharePoint](important-aspects-of-the-sharepoint-add-in-architecture-and-development-landscap.md)
    
  
-  [Справочник по схеме для манифестов SharePoint Add-ins](http://msdn.microsoft.com/library/1f8c5d44-3b60-0bfe-9069-1df821220691%28Office.15%29.aspx)
    
  
-  [Новый стандарт упаковки данных (OPC)](http://msdn.microsoft.com/ru-ru/magazine/cc163372.aspx)
    
  
-  [Приложения уровня данных](http://msdn.microsoft.com/ru-ru/library/ee210546.aspx)
    
  
-  [Web Deploy 2.0](http://www.iis.net/downloads/microsoft/web-deploy)
    
  

