---
title: 社交新聞摘要後的建立的雲端商務增益集
ms.prod: SHAREPOINT
ms.assetid: fe15c732-eea0-43cf-92e8-99ff776cb9e2
---


# 社交新聞摘要後的建立的雲端商務增益集
使用 Visual Studio 中的 **雲端商務增益集**範本，您可以建立 SharePoint 增益集在其中使用者可以檢視、 新增及更新的 SharePoint 資料。 **雲端商務增益集**專案類型使用 Visual Studio LightSwitch 技術，可大幅簡化建立商務增益集主控 SharePoint 上的程序。在這個逐步解說，您將建立增益集來追蹤工作應徵者善加利用 Office 365 社交整合功能 SharePoint 新聞摘要提供的增益集。您可以從 MSDN Code Gallery 下載完整的範例應用程式: [建立的雲端商務增益集社交新聞摘要後的](http://code.msdn.microsoft.com/Creating-a-Cloud-Business-8540c0c9)
## 必要條件

此逐步解說需要 Visual Studio 2013。
  
    
    
若要裝載增益集，您也需要 SharePoint 2013 網站或在 Office 365，您可以從 [註冊 Office 365 開發人員網站](http://go.microsoft.com/fwlink/?LinkId=263490)中取得的 SharePoint 開發人員網站。
  
    
    

## 建立雲端商務增益集專案
<a name="bk_create"> </a>

若要建立的雲端商務增益集，您會啟動與 **雲端商務增益集**專案範本 Visual Studio 中。
  
    
    

### 若要建立專案


1. 功能表列上，選擇 [ **檔案**、 **新增**、 **專案**]。
    
    [新增專案] 對話方塊隨即開啟。
    
  
2. 在範本清單中，展開 [ **Visual Basic**或 **Visual C#** ] 節點、 展開 [ **Office/SharePoint** ] 節點、 選擇 [ **增益集**] 節點，然後選擇 **雲端商務增益集**，如圖 1 所示。
    
   **圖 1。新增專案**

  

     ![Cloud Business App project template](images/CBAtemplate.PNG)
  

  

  
3. 在 [ **名稱**] 文字方塊中輸入CandidateTracker，，然後選擇 [ **確定**] 按鈕。
    
    **新的雲端商務增益集**精靈] 隨即開啟。
    
  
4. 在 [ **新的雲端商務增益集**精靈] 中輸入您的 Office 365 開發人員網站的 URL，，然後選擇 [ **完成**] 按鈕。
    
    URL 應該採取表單 https://  _MySite_.sharepoint.com/sites/Developer/。
    
    **CandidateTracker**解決方案之四個專案新增至 [方案總管: 最上層的 **CandidateTracker**專案、 **CandidateTracker.HTMLClient**專案、 **CandidateTracker.Server**專案和 **CandidateTracker.SharePoint**專案。
    
  

## 新增資料和畫面
<a name="bk_add"> </a>

應徵者追蹤器增益集必須將建立 **伺服器**專案和檢視、 新增和更新您將建立 **HTMLClient**專案中的資料的畫面中的資料庫資料表。
  
    
    

### 若要新增的資料庫表格


1. 在 **方案總管**] 中開啟 **CandidateTracker.Server**節點的快顯功能表並選擇 [ **新增表格**。
    
    實體設計工具會隨即開啟。
    
  
2. 在 [ **屬性**] 視窗中， **Name**屬性，如文字方塊中輸入候選項目。
    
  
3. 在實體設計工具中，選擇 **< 新增屬性 >**連結並輸入名稱。
    
  
4. 選擇 [ Enter鍵，接受預設的 **類型**、 **String**，並離開檢查 **所需**的核取方塊。
    
  
5. 選擇 **< 新增屬性 >**連結輸入電話，並選擇 [ **Tab**鍵。
    
  
6. 在 [ **類型**] 欄中，選擇 [ **電話號碼**，然後選擇Tab鍵按兩次。
    
    **電話號碼**是自訂商務類型的自動設定格式，並提供電話號碼的驗證。
    
  
7. [下一步] 資料列中輸入電子郵件 **名稱**，然後選擇 **電子郵件地址** **類型**。
    
    **電子郵件地址**是另一種自訂商務類型所提供的電子郵件地址驗證。
    
  
8. [下一步] 資料列中輸入ReferredBy **名稱**，然後選擇做為 **類型**的 **人員**。
    
    **人員**商務類型提供提取使用者資訊從 Active Directory SharePoint 使用者設定檔服務連線。
    
  
9. 在 [下一步] 資料列中輸入InterviewDate **名稱**，然後選擇 **類型**為 **日期時間位移**。
    
    **日期時間位移**商務類型儲存的日期和時間以 UTC 格式允許使用者在不同的時區查看正確的時間。
    
    圖 2 顯示已完成的實體。
    

   **圖 2。應徵者實體**

  

     ![Candidates table](images/CBAentity.PNG)
  

  

  

### 若要建立 [瀏覽] 畫面


1. 在實體設計工具] 的 **觀點**列上，選擇 [ **HTML 用戶端**] 索引標籤，然後在工具列上選擇 **畫面**。
    
    **新增新的畫面**] 對話方塊隨即開啟。
    
  
2. 在 [ **新增新的畫面**] 對話方塊的 [ **選取] 畫面上的範本**] 清單中選擇 [ **瀏覽資料畫面**。
    
  
3. 在 **畫面上的資料**] 清單中，選擇 [ **應徵者**，然後選擇 **[確定]**按鈕。
    
    開啟畫面設計工具的左窗格中，資料實體的表示法與螢幕版面配置在右窗格的表示法。
    
  
4. 在右窗格的畫面設計工具中選擇 [ **清單 |應徵者**] 節點，然後展開 [ **清單**] 清單並選擇 [ **表格**中，如圖 3 所示。
    
   **圖 3。[表格] 控制項**

  

     ![The BrowseCandidates screen designer](images/CBAscreen.PNG)
  

    這會以表格式格式，而非預設清單格式顯示 **應徵者**資訊。
    
    請注意除了您定義資料表的欄位有更多的四個欄位： 建立者、 建立、 修改、 及修改。這些欄位建立顯示項目已新增或上次更新時，以及由誰稽核記錄。
    
  

### 若要建立 [新增] 畫面


1. 在螢幕設計工具中，開啟 **命令列**節點的快顯功能表並選擇 [ **新增] 按鈕**。
    
  
2. 在 [ **新增] 按鈕**] 對話方塊中，依序展開 [ **showTab** ] 清單中選擇 **addAndEditNew**圖 4 所示，然後選擇 **[確定]**按鈕。
    
   **圖 4。[新增] 按鈕] 對話方塊**

  

     ![Add Button dialog box](images/CBAadd.PNG)
  

    **新增新的畫面**] 對話方塊隨即開啟。
    
  
3. 在 [ **新增新的畫面**] 對話方塊中，接受預設值並選擇 **[確定]**按鈕。
    
  
新的畫面設計工具視窗隨即開啟。
  
    
    

### 若要建立 [編輯] 畫面


1. 選擇 [ **BrowseCandidates.lsml**設計工具] 索引標籤，在畫面上設計工具中，選擇 [ **表格 |應徵者**節點。
    
  
2. 在 [ **屬性**] 視窗中，選擇 [ **項目點選**連結，如圖 5 所示。
    
   **圖 5。項目點選連結**

  

     ![Item Tap property](images/CBAproperty.PNG)
  

    **編輯項目點選 [動作**] 對話方塊隨即開啟。
    
  
3. 在 [ **編輯項目點選 [動作**] 對話方塊中，依序展開 [ **showTab** ] 清單中選擇 **editSelected**圖 6 所示，然後選擇 **[確定]**按鈕。
    
   **圖 6。編輯項目點選 [動作] 對話方塊**

  

     ![Edit ItemTap Action dialog box](images/CBAaction.PNG)
  

  

  

### 若要測試增益集


1. 在功能表列中，選擇 [偵錯] > [開始偵錯]。
    
    在您的電腦上執行 SharePoint 增益集的第一次系統提示您安裝 Localhost 憑證因為雲端商務增益集一律使用 SSL (安全通訊端層)。如果您接受此憑證、 安全性警告將不會顯示每次您啟動增益集。因為憑證只適用於 Localhost，您的系統朝沒有威脅。
    
  
2. 在 [ **安全性警訊**] 對話方塊中，選擇 [ **是**] 按鈕。
    
  
3. 如果 **安全性警告**] 對話方塊隨即出現，選擇 [ **是**] 按鈕。
    
    網頁瀏覽器中會出現。
    
  
4. 在 [ **登入**] 頁面上選擇 [ **登入]**按鈕。
    
  
5. 輸入您的密碼，然後選擇 [ **登入**] 按鈕。
    
  
6. 如果出現提示，請選擇 [ **信任該**按鈕。
    
  
7. **瀏覽應徵者**在畫面上，選擇 [ **新增候選項目**] 按鈕。
    
    **新增候選項目**] 畫面上會隨即開啟。
    
  
8. 按一下 [ **新增候選項目**] 畫面中輸入名稱、 電話號碼和電子郵件地址。
    
  
9. 選擇 [ **參照**] 欄位，並輸入您自己的名稱的前三個字元。
    
    您的全名應該會出現在清單中。如果您的網站連線至 Active Directory，您應該會看到其名稱開頭為相同的三個字元的所有使用者的清單。
    
  
10. (選用) 變更 **面試日期**日期和時間，然後選擇 [返回 [ **瀏覽應徵者**] 畫面上的 [ **儲存**] 按鈕。
    
    會顯示您剛新增的候選項目 ；如果您選擇資料列 **新增編輯應徵者**] 畫面上會隨即開啟。請注意的某些從其自訂商務類型繼承一些特殊行為。選擇 [選擇要傳送電子郵件，或將滑鼠停留在 [ **建立者**] 欄位來查看連絡人資訊的 **電子郵件**欄位、 撥打號碼的 **電話**欄位。
    
  
11. 關閉瀏覽器視窗停止執行的增益集。
    
  

## 新增新聞摘要
<a name="bk_feed"> </a>

其中一個 Office 365 的 SharePoint 功能已新增新聞摘要，讓使用者能夠在清單上追蹤活動及新增其註解的能力。雲端商務增益集可以輕鬆建立增益集的新聞摘要。
  
    
    

### 若要啟用社交整合


1. 選擇 [ **Candidates.lsml**設計工具] 索引標籤，然後選擇 [ **觀點**列上的 [ **伺服器**] 索引標籤。
    
  
2. 在 [ **屬性**] 視窗中，選取 [ **張貼在建立時**與圖 7 所示的 **張貼更新時**核取方塊。
    
   **圖 7。社交內容**

  

     ![Social properties](images/CBAsocial.PNG)
  

  

  
3. 選擇 [ **選擇張貼觸發程序**的連結。
    
    **選擇張貼觸發程序**] 對話方塊隨即出現。
    
  
4. 在 **選擇張貼觸發程序**] 對話方塊中，清除 **所有欄位**] 核取方塊、 選取 **面試日期**] 核取方塊，，然後選擇 [ **確定**] 按鈕。
    
  

### 若要測試增益集


1. 在功能表列中，選擇 [偵錯] > [開始偵錯]。
    
  
2. 在 **瀏覽應徵者**] 畫面上，選擇 [先前建立的候選項目。
    
  
3. 在 **新增編輯候選項目**] 畫面上，變更 **面試日期**]，然後選擇 [ **儲存**] 按鈕。
    
  
4. 選擇 [ **新增候選項目**] 按鈕，並新增其他候選項目。
    
  
5. 按一下 [ **瀏覽應徵者**] 畫面上的 SharePoint chrome 列中，選擇 [ **新聞摘要**] 連結。
    
    新增及更新應徵者的兩個項目與新的瀏覽器視窗中 **應徵者追蹤器新聞摘要**隨即開啟。您可以選擇貼文， **例如**連結或您可以選擇要新增註解的 [ **回覆**] 連結。
    
  
6. 關閉增益集無法執行停止這兩種瀏覽器視窗。
    
  

## 新增驗證
<a name="bk_validate"> </a>

在許多商務增益集將想要限制存取某些功能，例如，只允許管理員來變更面試日期。雲端商務增益集可讓您執行這項作業來撰寫驗證邏輯;在此例中您將撰寫程式碼來判斷目前的使用者是否特定 Active Directory 安全性群組的成員。
  
    
    

### 若要加入驗證


1. 選擇 [ **Candidates.lsml**設計工具] 索引標籤，然後選擇 [ **觀點**列上的 [ **伺服器**] 索引標籤。
    
  
2. 在工具列上，依序展開 [ **撰寫程式碼**清單並選擇 **Candidates_Validate**方法。
    
    程式碼編輯器中開啟。
    
  
3. 在程式碼編輯器中，會將下列程式碼新增至 **Candidates_Validate**方法：
    
  ```VB.net
  
If Not Application.User.Department = "Hiring Managers" Then
                results.AddEntityError("Permission denied")
            End If
  ```


  ```cs
  
if (!(Application.User.Department == "Hiring Managers")) {
results.AddEntityError("Permission denied");
}
  ```


    當使用者嘗試儲存的記錄會在執行 **Validate**方法。如果使用者是雇用管理員安全性群組的成員，記錄會儲存、 否則會顯示 「 使用權限遭拒 」 錯誤訊息及記錄都會捨棄。
    
  
此時若您執行增益集，並新增新候選項目可能即會錯誤訊息除非是實際的安全性成員群組名稱雇用經理。取代"雇用經理 」 名稱的安全性群組的屬於並再試一次。您現在應該有新增應徵者的權限。
  
    
    

## 後續步驟
<a name="bk_validate"> </a>

恭喜 ！您已建立您第一個雲端商務增益集。若這是您想要與使用者共用增益集下, 一步是以發佈增益集。請參閱 [How to: 發佈的雲端商務增益集至 Office 365](http://msdn.microsoft.com/en-us/library/vstudio/dn454601.aspx)或 [發佈 SharePoint 增益集](http://msdn.microsoft.com/en-us/library/office/apps/jj164070.aspx)。
  
    
    
當然，這只是簡單範例;還有更多要怎麼做才能建立全功能的增益集。由於的雲端商務增益集範本根據 LightSwitch 技術，您可能會想要瀏覽至要取得某些概念 LightSwitch 文件。請參閱 [LightSwitch SharePoint 增益集](http://msdn.microsoft.com/en-us/library/vstudio/jj969620.aspx)。
  
    
    

## 其他資源
<a name="bk_addresources"> </a>


-  [建立雲端商務增益集](create-cloud-business-add-ins.md)
    
  

