

# 應用程式事件接收器常見問題集
取得關於SharePoint 2013中使用應用程式事件接收器常見問題的解答。
 * **適用於:*** 
  
    
    


|||||
|:-----|:-----|:-----|:-----|
|**本文內容**                    [我可以在其中使用應用程式事件接收器？](#bkmk_WhereCanIUseAER)           [開啟網頁時，我找不到內容權杖](#bkmk_ContextToken)           [我在安裝應用程式時收到的錯誤](#bkmk_ErrorWhenInstalling)           [如何偵錯 「 我的應用程式事件接收器？](#bkmk_HowToDebug)           [我收到的錯誤時就會引發我應用程式事件接收器](#bkmk_ErrorWhenAERFires)           [當我將事件接收器新增至 「 我的應用程式時，會建立新的 AppWeb。真正是否需要新的 AppWeb 只處理一個事件吗？](#bkmk_DoINeedAnAppWebForEachEvent)           [為什麼要選擇不引發我應用程式事件接收器？](#bkmk_AppEventReceiverNotFiring)           [其他資源](#bk_addresources) <br/> ||
|**本文內容**                    [我可以在其中使用應用程式事件接收器？](#bkmk_WhereCanIUseAER)           [開啟網頁時，我找不到內容權杖](#bkmk_ContextToken)           [我在安裝應用程式時收到的錯誤](#bkmk_ErrorWhenInstalling)           [如何偵錯 「 我的應用程式事件接收器？](#bkmk_HowToDebug)           [我收到的錯誤時就會引發我應用程式事件接收器](#bkmk_ErrorWhenAERFires)           [當我將事件接收器新增至 「 我的應用程式時，會建立新的 AppWeb。真正是否需要新的 AppWeb 只處理一個事件吗？](#bkmk_DoINeedAnAppWebForEachEvent)           [為什麼要選擇不引發我應用程式事件接收器？](#bkmk_AppEventReceiverNotFiring)           [其他資源](#bk_addresources) <br/> ||
   

現在，您熟悉可能的功能SharePoint 2013呼叫的遠端事件接收器，以啟用 SharePoint 中包含 SharePoint 安裝外部資料的變更通知。不過，沒有其他類型的事件接收器，呼叫應用程式事件接收器，可以用來執行應用程式生命週期各階段任何程式碼。應用程式事件接收器可以處理三個事件：安裝、解除安裝，以及Upgraded。請參閱 ＜  [處理事件中 SharePoint 增益集](c050d056-8548-4496-a053-016779d723d9.md)如需詳細資訊。
  
    
    

以下是您可以使用應用程式事件接收器時的一般問題解答。
## 我可以在其中使用應用程式事件接收器？
<a name="bkmk_WhereCanIUseAER"> </a>

僅限雲端的SharePoint Online或Office 365環境中使用時，才支援應用程式事件接收器。
  
    
    

## 什麼是應用程式事件，以及它們是時引發嗎？
<a name="bkmk_WhereCanIUseAER"> </a>

您可以建立下列的事件處理常式：
  
    
    

- **安裝應用程式：**在安裝應用程式時執行。
    
  
- **解除安裝應用程式：** *無法*  移除該應用程式時執行。移除應用程式只會將應用程式移至使用者的資源回收筒。觸發事件應用程式解除安裝之前必須有兩個步驟。首先，使用者必須移除應用程式從其資源回收筒 」，以將它移到第二階段資源回收筒。其次，使用者必須清空第二階段資源回收筒。此最後一個工作會觸發解除安裝應用程式事件。
    
  
- **升級的應用程式：**更新應用程式時執行。
    
  

## 在 「 我的應用程式的事件處理常式可以時間完成上有時間限制吗？
<a name="bkmk_WhereCanIUseAER"> </a>

[是]。安裝應用程式事件實作必須完成，然後傳回 30 秒或 SharePoint 安裝基礎結構內 [SPRemoteEventResult](https://msdn.microsoft.com/library/Microsoft.SharePoint.Client.EventReceivers.SPRemoteEventResult.aspx) 物件會認為具有失敗。基礎結構會請重新執行事件， *然後重複您一開始的程式碼*  ，最多四倍。之後四個逾時，SharePoint 會回復整個應用程式安裝。我們建議下列作法：
  
    
    

- 如果您不能重複後逾時的處理常式中沒有任何程式碼，將它以查看如果它已經有執行測試的設定格式化的條件區塊中。您必須測試的實際的安裝的元件。只要變數設為 **true**至程式碼區塊完成時不適用於做為測試因為事件逾時，並重新啟動時，會重新初始化所有變數。
    
  
- 移動需要超過 30 秒至應用程式本身的安裝程式碼。您可以將它新增至執行第一次啟動應用程式的"第一次執行"邏輯。或者，該應用程式可能會出現提示使用者執行安裝程式碼。
    
  
- 如果上述的項目符號項目不是合適的您的應用程式，另一個作法是有事件處理常式啟動遠端非同步程序，並立即傳回 [SPRemoteEventResult](https://msdn.microsoft.com/library/Microsoft.SharePoint.Client.EventReceivers.SPRemoteEventResult.aspx) 物件。這項策略的缺點是如果遠端程序失敗，具有因而告訴 SharePoint 回復應用程式安裝。
    
  

## 開啟網頁時，我找不到內容權杖
<a name="bkmk_ContextToken"> </a>

如果您使用SharePoint 2013內部，Access Control Service (ACS)  這是負責產生的語彙基元  不會使用。因此會產生任何權杖，而且會發生錯誤。這是根據設計，因為在此例中 SharePoint 和應用程式是在相同的防火牆內。這表示已經兩者之間是高信任關係。
  
    
    

> **重要**
> 使用應用程式和遠端事件接收器僅支援SharePoint Online安裝中。
  
    
    


## 我在安裝應用程式時收到的錯誤
<a name="bkmk_ErrorWhenInstalling"> </a>

當安裝應用程式，可能會看到下列錯誤訊息：
  
    
    
 **@"錯誤 1
  
    
    
 CorrelationId： fe79ac5a-d462-44c8-be7b-2dc3b9a89689
  
    
    
 ErrorDetail： 遠端事件接收器註標失敗。
  
    
    
 ErrorType： 暫時性
  
    
    
ErrorTypeName： 間歇性
  
    
    
ExceptionMessage： 有沒有在可接受郵件的 https://localhost:44303/AppEventReceiver.svc 聆聽的端點。這通常是不正確地址或 SOAP 動作所造成。如果存在，如需詳細資訊，請參閱 ＜ 狀況。來源： 常用
  
    
    
SourceName： 一般應用程式部署**
  
    
    
或
  
    
    
 **沒有端點接聽**
  
    
    
如果您要取得這些錯誤，請開啟Visual Studio專案，並找出 **AppManifest**檔案。在此檔案中，變更 `~remoteAppUrl`以實際的 web 應用程式 URL  例如，  `https://myapp.onmyserver.com`。
  
    
    

## 如何偵錯 「 我的應用程式事件接收器？
<a name="bkmk_HowToDebug"> </a>

請參閱 ＜ [更新為偵錯 SharePoint 2013 使用 Visual Studio 2012 的遠端事件](http://blogs.msdn.com/b/officeapps/archive/2013/03/21/update-to-debugging-sharepoint-2013-remote-events-using-visual-studio-2012.aspx)。
  
    
    

## 我收到的錯誤時就會引發我應用程式事件接收器
<a name="bkmk_ErrorWhenAERFires"> </a>

當您的應用程式事件接收器就會引發時，您可能會看到下列錯誤：
  
    
    
 **失敗的遠端事件接收器圖說文字。詳細資料： 伺服器無法處理要求，因為內部錯誤。**
  
    
    
若要疑難排解此錯誤，您需要更多的資訊。您可以了解更多任一開啟的 [IncludeExceptionDetailInFaults](https://msdn.microsoft.com/library/System.ServiceModel.ServiceBehaviorAttribute.IncludeExceptionDetailInFaults.aspx) 在伺服器上以例外狀況資訊傳送至用戶端，或開啟 [追蹤](http://technet.microsoft.com/en-us/library/ee748656.aspx) ，並檢查伺服器追蹤記錄檔產生之。
  
    
    

## 當我將事件接收器新增至 「 我的應用程式時，會建立新的 AppWeb。真正是否需要新的 AppWeb 只處理一個事件吗？
<a name="bkmk_DoINeedAnAppWebForEachEvent"> </a>

[是]。(偶數應用程式事件接收器) 的遠端事件接收器的事件處理程式碼需要應用程式。如需詳細資訊，請參閱 ＜  [處理事件中 SharePoint 增益集](c050d056-8548-4496-a053-016779d723d9.md)。
  
    
    

## 為什麼要選擇不引發我應用程式事件接收器？
<a name="bkmk_AppEventReceiverNotFiring"> </a>

有一些事項，要怎麼做才能進行此問題的疑難排解。
  
    
    

- 開始進行疑難排解的第一個位置是在 [專案屬性。尋找 **SharePoint 事件的應用程式**] 區段中，在 [屬性] 視窗中。
    
  
- 接下來，您可以在程式碼] 檢視中開啟 AppManifest.xml 檔案，並尋找下一節。
    
  ```XML
  
<Properties>
<Title>MyAppTitle</Title>
<StartPage>~remoteAppUrl/Pages/Default.aspx?{StandardTokens}</StartPage>
<UninstallingEventEndPoint>~remoteAppUrl/AppEventReceiver.svc</UninstallingEventEndPoint>
<InstalledEventEndpoint>~remoteAppUrl/AppEventReceiver.svc</InstalledEventEndpoint>
</Properties>
  ```


    請確定的寫入 Url 以下對應至您的 Url 應。
    
  

## 其他資源
<a name="bk_addresources"> </a>


-  [處理事件中 SharePoint 增益集](c050d056-8548-4496-a053-016779d723d9.md)
    
  
-  [建立增益集事件接收器中 SharePoint 增益集](f40c910f-12a2-4caa-8e91-c7a61ae540db.md)
    
  
-  [偵錯及疑難排解中的 SharePoint 增益集的遠端事件接收器](21de092e-27f2-4000-bbb7-cb5cbfeaf195.md)
    
  