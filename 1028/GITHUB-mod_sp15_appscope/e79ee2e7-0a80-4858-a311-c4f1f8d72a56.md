

# 步驟 1： 在 SharePoint 2013 中建立一個清單為基礎提供者裝載應用程式
了解如何使用Visual Studio 2012 Office 開發人員工具建立SharePoint Add-in，以及如何啟動SharePoint Add-in推播通知功能。
This article is the first in a three-part series that shows how to create a companion mobile app for SharePoint. For more information, see  [如何： 建立 sharepoint 的同一系列文件行動應用程式的應用程式](d124d2ea-f772-495c-941c-6507d6da2c17.md).
  
    
    

在本節中的程序，您可以建立提供者主控SharePoint Add-in，是用來在此程序的下一個步驟中建立的小幫手應用程式。在本節中建立的應用程式會依可以代表客戶記錄客訴客戶支援專員做為桌面應用程式。檢視和編輯已指派給他們的工作，並取得推入通知，當新的工作會指派給他們，供會使用此應用程式的行動裝置的小幫手應用程式。
SharePoint Add-in有三種 SharePoint 清單及推播通知的新增功能。
  
    
    

After you create an SharePoint Add-in, you can choose to create a SharePoint-hosted app instead. If you choose to do this, you must use event handlers instead of remote event handlers for the push notification configuration step of this series ( [步驟 2： 設定推入 SharePoint 在提供者裝載的應用程式中的通知](5abfda20-118b-42bc-bc51-65f6ff6f7010.md)). * **適用於:*** 
|||
|:-----|:-----|
|**本文內容**          [建立提供者主控SharePoint Add-in的必要條件](e79ee2e7-0a80-4858-a311-c4f1f8d72a56.md#Step1_CreateASimpleAutohostedApp_Prerequisites)           [建立清單型SharePoint Add-in並啟用推播通知功能](e79ee2e7-0a80-4858-a311-c4f1f8d72a56.md#Step1_CreateASimpleAutohostedApp_CreateSimpleListBasedApp)           [後續步驟](e79ee2e7-0a80-4858-a311-c4f1f8d72a56.md#Step1_CreateASimpleAutohostedApp_NextStep)           [其他資源](#bk_addresources) <br/> |
  
    
    

  
    
    
 <br/> 
  
    
    
 <br/> |
   

## 建立提供者主控SharePoint Add-in的必要條件
<a name="Step1_CreateASimpleAutohostedApp_Prerequisites"> </a>

若要完成本文中的步驟，您將需要下列各項：
  
    
    

- An Office 365 Developer Site. For instructions on setting one up, see  [在 Office 365 上設定 SharePoint 增益集的開發環境](b22ce52a-ae9e-4831-9b68-c9210af6dc54.md). See  [開始開發 SharePoint 應用程式](d07e0a13-1e74-4128-857a-513dedbfef33.md) for guidance on how to set up a development environment that fits your needs.
    
  
- Visual Studio 2012
    
  
- Visual Studio 2012 Office 開發人員工具
    
  
- 測試、 偵錯SharePoint 2013安裝
    
  - 這可以是您開發的電腦，電腦上或您可以使用 「 遠端SharePoint 2013安裝，來開發和遠端安裝可位於SharePoint Online。如果您使用的遠端安裝時，您必須從 [SharePoint 用戶端元件](http://www.microsoft.com/en-us/download/details.aspx?id=35585)的用戶端物件模型可轉散發套件安裝在目標安裝。
    
  
  - 從開發人員網站定義 (其中您可以在管理中心中建立)，您必須建立測試 SharePoint 網站。
    
  
  - SharePoint 2013安裝必須設定為使用 OAuth。(開發人員網站佈建在SharePoint Online上測試網站時，它已設定為使用 OAuth。)
    
  

### 若要知道建立提供者主控應用程式的核心概念
<a name="CoreConcepts"> </a>

建立您第一個提供者主控應用程式之前，您應該有基本了解SharePoint Add-ins與 SharePoint 主控和提供者主控SharePoint Add-ins之間的差異。表格 1 中所列的各篇文章應該會，了解。
  
    
    

**表 1。建立提供者主控應用程式的核心概念**


|**文章標題**|**描述**|
|:-----|:-----|
| [SharePoint Add-ins](cd1eda9e-8e54-4223-93a9-a6ea0d18df70.md) <br/> |了解新的應用程式模型中的全部SharePoint 2013 ，可讓您建立應用程式]，亦即小型、 易於使用解決方案的使用者。 <br/> |
| [重要方面之 SharePoint 增益集架構設計和開發入門](ae96572b-8f06-4fd3-854f-fc312f7f2d88.md) <br/> |了解方面SharePoint Add-ins以及SharePoint 增益集相關的模型，包括主控選項、 使用者介面 (UI) 選項、 部署系統、 安全性系統及生命週期的應用程式的架構。 <br/> |
| [選擇如何開發和裝載您 SharePoint 的增益集的模式](05ce5435-0a03-4ddc-976b-c33b08d03457.md) <br/> |了解您能託管SharePoint Add-ins的各種方式。 <br/> |
   

## 建立清單型SharePoint Add-in並啟用推播通知功能
<a name="Step1_CreateASimpleAutohostedApp_CreateSimpleListBasedApp"> </a>

在此區段中，您可以建立包含地理位置欄位類型的 SharePoint 清單SharePoint Add-in 。
  
    
    

### 若要設定Visual Studio 2012解決方案和其元素


1. 在Visual Studio 2012，建立 **SharePoint 2013 的應用程式**專案從 **Office SharePoint**，範本樹狀目錄的 [ **新增專案**精靈] 中的 **應用程式**節點 (在任一 **C#** )。選擇 [ **提供者主控**主控選項。在繼續本文的範例中，C# 會做為語言和所是專案名稱。
    
  
2. 在精靈中，選擇 [ **完成]** 。解決方案開啟時可以完成許多的設定。以下是一些發生的最重要事項。
    
  - Visual Studio 2012 solution 中建立兩個專案： 一個適用於SharePoint Add-in ，一個用於ASP.NET web 應用程式。
    
  
  - SharePoint Add-in project **Web 專案**屬性設定為 web 應用程式專案的名稱。
    
  
  - The values in the AppManifest.xml file are set appropriately for a provider-hosted app. The **Start Page** URL is set by default to `~remoteAppUrl/Default.aspx` replace this with `~appWebUrl/Pages/Default.aspx?{StandardTokens}`. The **Query String** value is set to `{StandardTokens}`. This is also a token that resolves to a longer query string that includes an identification of the URL of the SharePoint website to which the remote web application communicates. Because neither the host web nor the app web URL is known until the app is installed, you need to use a token as the value of the query string. For more information about tokens in the app manifest, see  [SharePoint 資訊清單檔案的增益集](7cd5850f-cbf3-48d2-bcb7-59b8f4ed0e63.md#AppManifest) and [URL 字串及權杖中 SharePoint 增益集](800ec8cd-a448-46bc-b41e-d4030eeb4048.md).
    
  
  - **目標架構**的 web 應用程式設為Microsoft ASP.NET 4.0 (不Microsoft ASP.NET 4.5)。
    
  
  - Web 應用程式 **已啟用 SSL**屬性是設定為 **True**。
    
  
  - 參照即會為 SharePoint 用戶端物件模型的組件，以及 Microsoft 身分識別模型基礎結構的組件新增至 web 應用程式專案。
    
  
  - 名為 TokenHelper.cs 或 TokenHelper.vb 的來源檔案新增至 web 應用程式專案。
    
  
3. 在 [ **方案總管**中，選擇 [代表 (如果您執行這些程序中所使用的命名慣例，名為所) 之專案的節點。
    
  
4. 在 [ **專案**] 功能表上選擇 [ **新增**]， **新項目**]。 **新增項目**] 對話方塊隨即開啟以 Office/SharePoint 範本中，選擇 [ **清單**]。
    
  
5. 指定供作為名稱] 清單中，並選擇 [ **新增]**。在 **SharePoint 自訂精靈]**中，選擇 **架構可自訂的清單**，然後從下拉式清單中選擇 [ **預設值 (空白)** 。
    
    清單新增到解決方案之後，您可以新增欄至使用使用者介面的清單。
    
    在 **方案總管**中，選擇 [代表新建立的清單 (名為 **供**如果遵循這些程序中所使用的命名慣例) 的節點。開啟選取的節點，以開啟供清單的清單設計工具中，並新增的欄和表 1 所示的欄位類型。刪除欄，新的資料行新增至清單之前所建立的清單。
    

   **表 1。技術人員清單**


|**欄**|**類型**|**必要**|
|:-----|:-----|:-----|
|標題 <br/> |單行文字 (文字) <br/> |是 <br/> |
|名稱 <br/> |個人或群組 <br/> |否 <br/> |
|職稱 <br/> |單行文字 (文字) <br/> |是 <br/> |
|專業能力 <br/> |單行文字 (文字) <br/> |否 <br/> |
|位置 <br/> |地理位置 <br/> |否 <br/> |
   
6. 重複步驟 4，建立一個多個清單與 **通知**，做為在您SharePoint Add-in清單的名稱。
    
  
7. 重複步驟 5 中，並使用表格 2 來建立 **通知**上述步驟中建立清單的欄。
    
   **表 2。通知清單**


|**欄**|**類型**|**必要**|
|:-----|:-----|:-----|
|Title <br/> |單行文字 (文字) <br/> |是 <br/> |
|通知階段 <br/> |單行文字 (文字) <br/> |否 <br/> |
|狀態碼 <br/> |單行文字 (文字) <br/> |是 <br/> |
|服務權杖 <br/> |單行文字 (文字) <br/> |否 <br/> |
|標頭 <br/> |單行文字 (文字) <br/> |否 <br/> |
|間隔值 <br/> |單行文字 (文字) <br/> |否 <br/> |
   
8. 若要新增的第三個清單中您SharePoint Add-in，請重複步驟 4。名稱] 清單中，為指定的情況下，然後選擇 [ **新增]**。在 **SharePoint 自訂精靈]**中，選擇 [ **自訂清單**中，，然後選擇 **工作**從下拉式清單。
    
    在 **方案總管**中，選擇 [] 節點，表示新建立的清單 (如果您執行這些程序中所使用的命名慣例，名為 **的情況下**)。開啟 [選取的節點，以便在清單設計工具中開啟的情況下清單和一個將欄新增至現有的欄 **客戶地址**為 [顯示名稱] 和 [ **多行文字**欄位作為欄位類型的欄。
    
  
9. In the AppManifest.xml file, add the following code. To learn more about Permissions, see  [增益集 (英文) SharePoint 2013 權限](5f7a8440-3c09-4cf8-83ec-c236bfa2d6c4.md)
    
  ```XML
  
<AppPermissionRequests>
    <AppPermissionRequest Scope="http://sharepoint/content/sitecollection/web" Right="FullControl" />
  </AppPermissionRequests>
  ```


### 將預設頁面新增至應用程式


1. 在 **方案總管**中，選擇 [代表新建立的清單 (名為 **所**如果遵循這些程序中所使用的命名慣例) 的節點。將.aspx 頁面新增至解決方案。
    
  
2. 新增下列程式碼內的本文的頁面
    
  ```HTML
  
<div>
        <p>
            <table cellpadding="20">
                <tr>
                    <td valign="top" align="left">
                        <p>
                            <a href="../Lists/Cases">Support Cases</a>
                        </p>
                        <p>
                            <a href="../Lists/Technicians">Technicians</a>
                        </p>
                        
                        <p>
                            <a href="../Lists/Notifications">Notifications</a>
                        </p>
                        
                    </td>
                </tr>
            </table>
        </p>
    </div>
  ```

In the following steps, you activate the push notification feature in your SharePoint Add-in. This step is only to  *activate*  the push notification feature. To *send*  push notifications, you need to add remote event receivers, which is covered in [步驟 2： 設定推入 SharePoint 在提供者裝載的應用程式中的通知](5abfda20-118b-42bc-bc51-65f6ff6f7010.md).
  
    
    

### 若要啟用推播通知功能 apps for SharePoint


1. 在 [ **方案總管**中，選擇，並依序展開 [ **功能**] 節點。
    
  
2. 在功能設計工具中， **功能啟動相依性**] 節點中，依序展開，然後選擇 [ **新增**] 按鈕。
    
  
3. 在 [ **新增功能啟動相依性**] 對話方塊中，選擇 [ **新增解決方案中的功能的相依性**] 選項按鈕、 輸入您要新增為相依性功能之標題中的 **推入通知**、 在 [功能識別碼] 文字方塊中輸入41e1d4bf-b1a2-47f7-ab80-d5d6cbba3092並 (選擇性) 新增描述。然後選擇 [ **新增**] 按鈕。
    
    若要深入了解新增一種功能，請參閱 [How to： 新增及移除功能相依性](http://msdn.microsoft.com/en-us/library/ee231535.aspx)。
    
  

## 後續步驟
<a name="Step1_CreateASimpleAutohostedApp_NextStep"> </a>

In the next step,  [步驟 2： 設定推入 SharePoint 在提供者裝載的應用程式中的通知](5abfda20-118b-42bc-bc51-65f6ff6f7010.md), you will learn how to create push notifications for a provider-hosted SharePoint Add-in using a remote event receiver.
  
    
    

## 其他資源
<a name="bk_addresources"> </a>


-  [如何： 建立 sharepoint 的同一系列文件行動應用程式的應用程式](d124d2ea-f772-495c-941c-6507d6da2c17.md)
    
  
-  [開發 SharePoint 的增益集](71ddde4b-fac4-4d8c-aa2e-524f9c2c4c99.md)
    
  
-  [建置存取 SharePoint 2013 的 Windows Phone 應用程式](http://msdn.microsoft.com/library/36681335-f772-4499-8445-f94481bc18e7%28Office.15%29.aspx)
    
  
-  [開始建立 SharePoint 主控 SharePoint 增益集](1b992485-6efe-4ea4-a18c-221689b0b66f.md)
    
  
-  [整合在 SharePoint 2013 中的位置和對應功能](http://msdn.microsoft.com/library/10d4a904-ed27-4513-8c20-d2098aebf22c%28Office.15%29.aspx)
    
  