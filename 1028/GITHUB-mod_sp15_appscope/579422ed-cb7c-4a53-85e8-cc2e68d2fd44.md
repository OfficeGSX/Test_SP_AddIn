
# 如何： 使用 Visual Studio 來部署自訂搜尋設定
了解如何使用Visual Studio部署SharePoint Add-ins自訂的搜尋設定。
 * **適用於:*** 
  
    
    

 **本文內容**
  
    
    
 [必要條件](#Prerequisites)
  
    
    
 [建立查詢來源和查詢規則，請搜尋 MSDN](#CreateQuery)
  
    
    
 [測試查詢規則](#TestQuery)
  
    
    
 [匯出的搜尋設定](#ExportConfig)
  
    
    
 [使用Visual Studio部署的搜尋設定](#Deploy)
  
    
    
 [確認自訂搜尋設定](#Test)
  
    
    
 [的其他資源](#bk_addresources)
您可以傳回結果的標準搜尋網域外部自訂您的搜尋設定為包括，例如，企業搜尋中心網站。如果自訂搜尋組態時，從外部來源的目標的結果會出現在結果區塊其他結果上方。例如，您可以搜尋"SharePoint 2013 應用程式的"來包含這些字詞的 SharePoint 網站上取得主題的清單。如果您自訂的搜尋設定，然後搜尋"MSDN"除了這些條款，MSDN 拜訪人次會出現在結果區塊。
  
    
    

本文說明如何擴充超過 SharePoint 網站中，將搜尋結果，但您也可以自訂的其他方式搜尋。在這個範例中，您可以定義自訂的查詢規則及 sharepoint 的 Bing 開啟搜尋查詢來源。當您包含特定關鍵字結尾處的搜尋字串 (在此例中， **msdn**)，就會引發查詢規則，並 MSDN 結果會出現在結果區塊上方的 [搜尋] 頁面。您可以建立查詢規則及查詢來源更輕鬆地在 SharePoint 中使用設計工具。您可以定義的搜尋組態設定之後，您將其匯出為單一的 XML 檔案，其中包含的所有可匯出設定，例如查詢設定、 排名模型，以及結構描述。您再匯入 XML 檔案中Visual Studio， SharePoint Add-in ，您用來測試及自訂應用程式的企業搜尋中心。您確認的搜尋組態正確運作之後，您會封裝與部署至 SharePoint 的應用程式及及其搜尋設定。
> [!注意事項]
> 以 「 端載入 「 應用程式 (亦即，以使用Visual Studio部署至 SharePoint 網站的應用程式)，您需要使用 PowerShell 命令，而不是網站範本的企業搜尋中心。請參閱 ＜ [快速開始開發新的"0-60"開發人員經驗的應用程式的](http://blogs.msdn.com/b/officeapps/archive/2013/01/21/quickly-start-developing-apps-with-the-new-0-60-developer-experience.aspx)。
  
    
    


## 必要條件
<a name="Prerequisites"> </a>


- Visual Studio本機安裝。
    
  
- Office Developer Tools for Visual Studio本機安裝。
    
  
- SharePoint 開發人員網站。
    
  
- 企業搜尋中心網站。
    
  
- 如果您正在 sharepoint 開發應用程式中Office 365Office 365訂閱。
    
  

### Core concepts

開始這些程序之前，請先了解如何搜尋 SharePoint 工作、 如何設定 SharePoint 開發人員網站，以及如何設定企業搜尋中心網站中的 [作業。您應該透過檢閱下表中的各項主題的入侵，了解。
  
    
    

**表 1。自訂 SharePoint 搜尋的核心概念**


|**文章標題**|**描述**|
|:-----|:-----|
| [建立 SharePoint Server 2013 的搜尋中心網站](http://go.microsoft.com/fwlink/?LinkId=283972) <br/> |了解如何建立企業搜尋中心網站並授與存取權的使用者。 <br/> |
| [在 SharePoint Server 2013 中管理查詢規則](http://go.microsoft.com/fwlink/?LinkId=283973) <br/> |了解如何藉由建立及管理查詢規則改進搜尋結果。 <br/> |
| [在 SharePoint Server 2013 中管理搜尋](http://go.microsoft.com/fwlink/?LinkId=283974) <br/> |了解如何在 SharePoint 2013 中改善搜尋結果，以及如何管理編目、搜尋結構描述及搜尋拓撲。 <br/> |
| [匯出及匯入自訂的 SharePoint Server 2013 中的搜尋組態設定](http://technet.microsoft.com/en-us/library/jj871675.aspx) <br/> |了解如何匯出及匯入 SharePoint 網站集合與網站之間的搜尋設定。 <br/> |
   

## 建立查詢來源和查詢規則，請搜尋 MSDN
<a name="CreateQuery"> </a>

查詢來源指出搜尋所在的 URL，它會使用的通訊協定。在此情況下，它會 Bing 搜尋使用 OpenSearch 通訊協定。查詢規則會指定執行查詢的準則。在此例中的字數 **msdn**觸發查詢。
  
    
    

### 若要建立的查詢來源的 MSDN


1. SharePoint 開發人員在網站上，開啟 [ **設定**] 頁面。
    
  
2. 在 [ **網站集合管理**] 區段中，選擇 [ **搜尋結果來源**] 連結，然後選擇 **新結果來源**] 連結。
    
  
3. 在 [ **新增結果來源**] 頁面上，新增下列屬性值：
    
   **表 2。[新增結果來源] 頁面上的屬性設定**


|**屬性**|**值**|
|:-----|:-----|
|名稱 <br/> |MSDN 查詢來源 <br/> |
|描述 <br/> |MSDN 查詢來源 <br/> |
|通訊協定 <br/> |OpenSearch 1.0/1.1 [如果您選擇這個選項，您重新整理頁面。] <br/> |
|Source URL <br/> |http://www.bing.com/search?q=site:msdn.microsoft.com+{searchTerms}&amp;format=rss <br/> |
   
4. 選擇您剛新增的查詢來源，然後選擇 [ **測試來源]**命令，以確認是否查詢是否運作正常。
    
  

### 若要建立查詢規則的 MSDN


1. 在 [ **設定**] 頁面的 [ **網站集合管理**] 區段中，選擇 [ **搜尋查詢規則**] 連結。
    
  
2. 在 [ **管理查詢規則**] 頁面上，選擇 [ **本機 SharePoint 結果**清單項目為您要設定查詢規則的內容。
    
  
3. 選擇 [ **新增查詢規則**] 連結。
    
  
4. 在 [ **新增查詢規則**] 頁面上，新增下列屬性值：
    
   **表 3。[新增查詢規則] 頁面上的屬性設定**


|**屬性**|**值**|
|:-----|:-----|
|規則名稱 <br/> |MSDN 查詢規則 <br/> |
|查詢條件 <br/> |進階查詢文字比對 <br/> |
|查詢包含這些片語之一] <br/> |msdn ；MSDN ； <br/> |
   
5. 選取 **結尾的查詢比對，但不是整個查詢**] 核取方塊，並清除 **整個查詢完全符合**] 核取方塊。
    
  
6. 選擇 [ **新增結果區塊**] 連結。
    
  
7. 在 [ **新增結果區塊**] 頁面上，新增下列屬性值。(保留其他屬性的目前值)。
    
   **表 4。[新增結果區塊] 頁面上的屬性設定**


|**屬性**|**值**|
|:-----|:-----|
|區塊標題 <br/> |MSDN 的"{subjectTerms}"中的結果區塊標題 <br/> |
|搜尋此來源 <br/> |MSDN 查詢來源 <br/> |
|項目 <br/> |5 <br/> |
   
8. 選擇 [建立結果區塊中，[ **確定**] 按鈕，然後選擇 [ **儲存**] 按鈕，來建立 MSDN 查詢規則。
    
  

## 測試查詢規則
<a name="TestQuery"> </a>

定義查詢來源與規則，現在您可以測試結果。
  
    
    

### 若要測試之查詢規則


1. 在頁面左上角部分，選擇 [瀏覽至 [首頁] 頁面上的 SharePoint 標誌圖示。
    
  
2. Sharepoint 2013 應用程式 msdn，搜尋然後確認 [結果區塊的 MSDN 出現在 [結果] 頁面上。
    
    封鎖會表示標題 **的 「 sharepoint 2013 應用程式 msdn"MSDN 結果**，並在左結果的線條。其他結果，如果有的話，會出現在結果區塊。
    
  

## 匯出的搜尋設定
<a name="ExportConfig"> </a>

之後您驗證結果區塊的運作，匯出至 XML 檔案，您可以匯入Visual Studio的搜尋設定。
  
    
    

### 若要匯出的搜尋設定


1. 在 SharePoint 中的 [ **網站設定**] 頁面上的 [ **網站集合管理**] 區段中，選擇 [ **搜尋組態匯出**] 連結。
    
  
2. 儲存 SearchConfiguration.xml 檔案。
    
    > [!注意事項]
      > 我們建議您自訂 SharePoint 中的搜尋組態、 將它匯出至 XML 檔案，並再將檔案匯入搜尋設定專案中Visual Studio。

## 使用Visual Studio部署的搜尋設定
<a name="Deploy"> </a>

您使用的搜尋組態專案Visual Studio中部署的搜尋設定。
  
    
    

### 若要部署的搜尋設定


1. 在Visual Studio，建立 SharePoint 專案，應用程式，專案命名為"MSDN 搜尋 Sample"。
    
  
2. 在 [ **新增 SharePoint 的應用程式**] 對話方塊中，主控類型設為 **SharePoint 主控**，並指定的網站的 URL 企業搜尋 (已啟用端-載入的應用程式) 適用於偵錯。
    
  
3. 將 **搜尋設定**專案項目新增至您剛才建立的專案。
    
  
4. 在 [ **匯入的搜尋組態設定**] 對話方塊中，瀏覽至您先前匯出的 SearchConfiguration.xml 檔案。
    
  
5. 在 SearchConfigurationSettings.xml 檔案中，變更 **DeployToParent**屬性的值設 **為 true**。
    
  
6. 在 **方案總管**中，開啟 AppManifest.xml 在資訊清單的設計工具]，然後選擇 [ **權限**] 索引標籤在設計工具中。
    
  
7. 在 [ **權限**] 索引標籤中，新增下列權限：
    
   **表 5。權限設定**


|**屬性**|**值**|
|:-----|:-----|
|範圍 <br/> |網站集合 <br/> |
|權限 <br/> |完全控制 <br/> |
   

## 確認自訂搜尋設定
<a name="Test"> </a>

自訂的搜尋設定之後，請確認在 SharePoint 中的搜尋組態是否正確。
  
    
    

### 若要確認的自訂搜尋設定


1. 在Visual Studio，選擇 [F5 鍵以偵錯 SharePoint 中的專案。
    
  
2. 在頁面左上角，選擇 [ **企業搜尋示範**按鈕瀏覽至主機網頁。
    
  
3. 在 SharePoint 中的 [ **網站設定**] 頁面上的 [ **網站集合管理**] 區段中，選擇 [ **搜尋結果來源**] 連結。
    
  
4. 選擇以開啟 [結果來源] 頁面上，確認來源 URL 有效， **MSDN 查詢來源**] 連結，然後選擇 [ **儲存**] 按鈕。
    
  
5. 選擇要返回 [ **網站設定**] 頁面上的 **網站集合管理**標頭。
    
  
6. 在 SharePoint 中的 [ **網站設定**] 頁面上的 [ **網站集合管理**] 區段中，選擇 [ **搜尋查詢規則**] 連結。
    
  
7. 您可以選擇清單中的 **[本機 SharePoint 結果**為結果來源。
    
  
8. 選擇 [ **MSDN 查詢規則**] 連結，以確認查詢規則。
    
  
9. 在 [ **結果區塊**] 區段中，選擇 [ **編輯**] 連結。
    
  
10. 確認正確的結果區塊，並選擇 [ **確定**] 按鈕，然後選擇 [ **儲存**] 按鈕。
    
  
11. 在頁面左上角，選擇 [瀏覽至應用程式的 [首頁] 頁面上的 SharePoint 標誌。
    
  
12. Sharepoint 2013 應用程式 msdn，搜尋然後確認 [結果區塊的 MSDN 隨即顯示。
    
  
13. Sharepoint 2013 應用程式，搜尋然後確認 [MSDN 結果區塊不會出現。
    
    如果您省略 **msdn**中搜尋關鍵字，則會移除觸發程序可建立結果區塊。
    
  
